{"version":3,"sources":["../webpack/bootstrap","../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArray.js","../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../node_modules/@babel/runtime/helpers/esm/objectSpread2.js","../node_modules/@babel/runtime/helpers/esm/classCallCheck.js","../node_modules/@babel/runtime/helpers/esm/createClass.js","../node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseBase.js","../node_modules/@babel/runtime/helpers/esm/classPrivateFieldLooseKey.js","fitter/src/Fit.js","components/FitCard/Stats/services/EveMath.js","../node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/inherits.js","../node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/esm/typeof.js","../node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/esm/createSuper.js","../node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","services/dataManipulation/findAttributes.js","components/FitCard/Stats/services/Stat.js","components/FitCard/Stats/services/Summary.js","components/FitCard/Stats/services/Simulator.js","../node_modules/@babel/runtime/helpers/esm/readOnlyError.js","components/FitCard/Stats/services/SimWorker.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_arrayLikeToArray","arr","len","length","arr2","Array","_toConsumableArray","isArray","iter","iterator","from","minLen","toString","slice","constructor","test","TypeError","_defineProperty","obj","configurable","writable","ownKeys","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","push","apply","_objectSpread2","target","arguments","source","forEach","getOwnPropertyDescriptors","defineProperties","_classCallCheck","instance","Constructor","_defineProperties","props","descriptor","_createClass","protoProps","staticProps","_classPrivateFieldBase","receiver","privateKey","id","_classPrivateFieldKey","Fit","dogmaSkills","skillBoard","skillsStaticBoardMax","values","reduce","acc","mods","concat","map","mod","debug","undefined","falseDebug","validateChargeSlot","slot","item","charge","itemChargeSize","chargeChargeSize","loadableGroupIDs","ID","attr","includes","groupID","itemCapacity","capacity","chargeVolume","volume","chargePerCycle","chargeVolumePerAct","Math","floor","mapSlots_CONFIG","isIterate","ship","miscSlots","highSlots","midSlots","lowSlots","rigSlots","droneSlots","mapSlots","fit","callback","partialConfig","config","slotName","slots","fitWithDomainID","board","staticBoard","passiveBoard","modifiedAttributeID","isStatic","appliedMod","type","typeAttributesStats","attribute","attributeID","penCount","console","log","baseMod","baseValue","modifyingAttributeValue","operation","appliedValue","penalizedModifyingAttributeValue","isPenalized","modifyingAttributeID","sampleMod","compareFunc","highIsGood","modifiedAttributeHighIsGood","a","b","modStackables","modNotStackables","isStackException","modifiedAttributeStackable","sort","index","array","targetMod","applyMod","domain","func","domainID","typeGroupID","typeSkills","skillTypeID","error","split","typeState","effectCategory","skills","typeID","skillsBoard","skill","typeName","itemMods","chargeMods","dogmaSkill","invalidEffectIDs","extrovertEffects","typeEffectsStats","effect","modifierInfo","effectID","modifyingAttribute","effectName","iconID","getCurrentState","getInitialState","efft","initialState","currentState","find","entry","applyValue","mulValue","perValue","addValue","subValue","divValue","pow","E","EveMath","Cmax","Cnow","Tchg","sqrt","summary","owner","onBoardVector","situation","vector","hostileVector","distanceVector","x","anchors","anchor1X","y","anchor1Y","distance","trackingValue","range","tracking","signatureResolution","signatureRadius","misc","_angularVelocity","_trackingPart","getRangeModifier","toFixed","optimalRange","isSentry","getTurretAcurracy","targetUnitVector","targetVelocity","propulsion","orbitVelocity","droneAccuracyModifier","absoluteVelocity","droneVector","droneSituationsummary","orbitRange","explosionRadius","explosionVelocity","damageReductionFactor","simplePart","complexPart","min","randomDamageModifier","random","optimal","falloff","falloffRange","denominator","numerator","max","_distancePart","_setPrototypeOf","setPrototypeOf","__proto__","_inherits","subClass","superClass","_getPrototypeOf","getPrototypeOf","_typeof","_possibleConstructorReturn","self","ReferenceError","_createSuper","Derived","hasNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","e","result","Super","NewTarget","this","findAttributebyID","maximumVelocity","angularVelocity","fallOff","perpendicularVector","perpendicularUnitVector","unitVector","velocityVector","Stat","propCapacitor","capacitor","damage","defense","stableLevel","capacitor_stableLevel","engineering","resource","miscellaneous","turretLauncherDamage","effective","alpha","turretLauncherRange","droneDamage","turrets","launchers","drones","turretLauncherDamageSummaries","damage_getSummary","damagePerAct","maxDps","activationInfo","duration","effectiveDps","e_duration","overlappingRange","droneSummaries","drone","typeCount","damageSummaries","ambientChargeRate","boosterChargeRate","activationUseRate","cus","capacitorUsePerSec","dominID","Tnow","capacitorDeltas","capacitorLevel","delta","getAmbientChargeRateMath","positiveDeltas","capacitorDelta","capacitorBonus","resistance","defense_resistance","active","armor","HP","EM","TH","KI","EX","shield","structure","shieldBonus","armorBonus","structureBonus","pg","load","output","cpu","pgLoad","pgOutput","cpuLoad","cpuOutput","Number","turret","launcher","calibration","droneBandwidth","droneBay","droneActive","turretHardpoint","launcherHardpoint","droneCapacity","mountedTurrets","mountedLaunchers","mountedCalibration","mountedDroneBandwidth","droneVolume","sensor","scanResolution","maximumLockedTarget","maximumTargetingRange","strength","gravimetric","magnetometric","ladar","radar","inertialModifier","warpSpeedMultiplier","cargoBayCapacity","gravimetricSensorStrength","magnetometricSensorStrength","ladarSensorStrength","radarSensorStrength","Infinity","activationLimit","reloadTime","activationCost","activationTime","defaultStat","isTurretFitted","isActivated","isLauncherFitted","damage_damagePerAct","getActivationInfo","damage_range","damageModifier","EM_damage","TH_damage","KI_damage","EX_damage","isDrone","typeDroneSize","chargeInfo","capacitor_getChargeInfo","bonusRate","boosterSlot","capacitor_getBonusPerAct_self","shipAttrs","armorHP","armorEM","armorTH","armorKI","armorEX","shieldHP","shieldEM","shieldTH","shieldKI","shieldEX","shieldChargeRate","structureHP","structureEM","structureTH","structureKI","structureEX","defense_getSummary","bonusPerAct","defense_getBonusPerAct","activePropulsionModules","isPropulsionModule","shipBaseMaximumVelocity","propModuleMaximumVelocityBonusMul","propModuleThrust","propModuleMassAdd","shipMass","mass","thisEffectsNeedCharge","capPrioritySet","alwaysOn","mostTrivial","turretDamage","shieldHarden","shieldBoost","shieldBoostAncillaryFueled","shieldBoostAncillary","armorHardener","armorBoost","armorBoostAncillaryFueled","armorBoostAncillary","damageControl","structureBoost","capacitorNeutralizer","capacitorTransmitter","Summary","booster_bonusPerAct","transfer_bonusPerAct","neut_bonusPerAct","isNosferatuBloodRaiderOverriden","isCapacitorTransmitter","isNosferatu","updateSummaries","summarizedSlots","shipSummary","getSummary_ship","assign","_slot","SimFit","toPath","path","activationState","addSummaries","_slots","addSummaries_duplicateSlots","_droneSlots","addSummaries_duplicateDroneSlots","JSON","parse","stringify","slotCount","slotString","fill","moduleSummary","heatDamage","activationDataSet","createActivationDataSet","join","effectSummary","getSummary_damage","getSummary_defense","getSummary_capacitor","activationPriority","getActivationPriority","marketGroupID","droneSumamry","getSummary_drone","situation_decription","isActive","lastActivation","nextActivation","nextActivationTick","activationLeft","shieldHardener","state","targetSlot","Simulator","fit1","summarizedSlots1","onboard","summarizedSlots2","hostile","HAL","manageActivation_getCapUsageLevels","capLog","schedules","getSchedules","manageSchedules","simulate_oneTick","tick","simulate_capacitor","simulate_shield","activateDamage","activateDefense","activateCapacitor","capacitorState","capacitorInfo","shieldState","shieldInfo","root","situationalModifiedSummary","activateDamage_getAlpha","shieldDamage","remaining","appplied","armorDamage","structureDamage","shot","damageCapMultiplier","alpha_damaging","EM_applied","EM_damaging","TH_applied","TH_damaging","KI_applied","KI_damaging","EX_applied","EX_damaging","alpha_applied","EM_remaining","EM_blocked","TH_remaining","TH_blocked","KI_remaining","KI_blocked","EX_remaining","EX_blocked","alpha_blocked","situationalMul","droneAccuracy","getDroneAccracy","getTurretRandomDamageModifier","turretAccuracy","launcherAccracy","getLauncherAccuracy","getLauncherDamageModifier","ownerCapacitorHP","targetCapacitorHP","bonusPerActOwner","bonusPerActTarget","maxBonusPerAct","symmetricBonusPerAct","rangeModifier","simulateActivation","info","getSchedules_setTarget","summarizedSlot","fragment","time","schedule","manageSchedules_validate","isCapacitorValidated","manageSchedules_validateCapacitor","isStructureValidated","manageSchedules_validateStructure","rootStructureHP","Error","_target","_summary","currentTime","warn","subSecSchedule","capUsageRates","capUsageRate","simulate","slots1"],"mappings":"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","file":"c134064299505ba38d3a.worker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayWithoutHoles from \"@babel/runtime/helpers/esm/arrayWithoutHoles\";\nimport iterableToArray from \"@babel/runtime/helpers/esm/iterableToArray\";\nimport unsupportedIterableToArray from \"@babel/runtime/helpers/esm/unsupportedIterableToArray\";\nimport nonIterableSpread from \"@babel/runtime/helpers/esm/nonIterableSpread\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","import arrayLikeToArray from \"@babel/runtime/helpers/esm/arrayLikeToArray\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nexport default function _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","export default function _classPrivateFieldBase(receiver, privateKey) {\n  if (!Object.prototype.hasOwnProperty.call(receiver, privateKey)) {\n    throw new TypeError(\"attempted to use private field on non-instance\");\n  }\n\n  return receiver;\n}","var id = 0;\nexport default function _classPrivateFieldKey(name) {\n  return \"__private_\" + id++ + \"_\" + name;\n}","export default class Fit {\r\n  static validateChargeSlot = function (slot) {\r\n    if (!slot || !slot.item || !slot.charge) return false;\r\n\r\n    const item = slot.item;\r\n    const charge = slot.charge;\r\n\r\n    // Charge size[attributeID] = 128\r\n    const itemChargeSize = Fit.#common_findAttributeByID(item, 128);\r\n    const chargeChargeSize = Fit.#common_findAttributeByID(charge, 128);\r\n    if (\r\n      !!itemChargeSize &&\r\n      !!chargeChargeSize &&\r\n      itemChargeSize.value !== chargeChargeSize.value\r\n    )\r\n      return false;\r\n\r\n    // Used with (Charge Group)[attributeID] = 604, 605, 606, 609, 610\r\n    const loadableGroupIDs = [604, 605, 606, 609, 610]\r\n      .map((ID) => {\r\n        const attr = Fit.#common_findAttributeByID(item, ID);\r\n        if (!attr) return undefined;\r\n        else return attr.value;\r\n      })\r\n      .filter((value) => value);\r\n    if (loadableGroupIDs.length === 0) return false;\r\n\r\n    if (!loadableGroupIDs.includes(charge.groupID)) return false;\r\n\r\n    const itemCapacity = item.capacity;\r\n    const chargeVolume = charge.volume;\r\n    const chargePerCycle = Fit.#common_findAttributeByID(item, 56)?.value; //attributeID: 56, attributeName: \"Charges Per Cycle\"\r\n    const chargeVolumePerAct = !!chargePerCycle\r\n      ? chargeVolume * chargePerCycle\r\n      : 0;\r\n    const activationLimit = Math.floor(itemCapacity / chargeVolumePerAct);\r\n    if (activationLimit <= 0) return false;\r\n\r\n    return true;\r\n  };\r\n\r\n  static mapSlots_CONFIG = {\r\n    isIterate: {\r\n      ship: false,\r\n      miscSlots: false,\r\n      highSlots: false,\r\n      midSlots: false,\r\n      lowSlots: false,\r\n      rigSlots: false,\r\n      droneSlots: false,\r\n    },\r\n  };\r\n  static mapSlots = function (fit, callback, partialConfig) {\r\n    const config = {\r\n      isIterate: {\r\n        ...Fit.mapSlots_CONFIG.isIterate,\r\n        ...partialConfig.isIterate,\r\n      },\r\n    };\r\n\r\n    return [\r\n      \"ship\",\r\n      \"miscSlots\",\r\n      \"highSlots\",\r\n      \"midSlots\",\r\n      \"lowSlots\",\r\n      \"rigSlots\",\r\n      \"droneSlots\",\r\n    ].reduce((acc, slotName) => {\r\n      if (config.isIterate[slotName] === true)\r\n        return acc.concat(Fit.#mapSlots_slots(fit[slotName], callback));\r\n      else return acc;\r\n    }, []);\r\n  };\r\n  static #mapSlots_slots = function (slots, callback) {\r\n    if (!slots) return [];\r\n    return slots.map((slot) => {\r\n      return callback(slot);\r\n    });\r\n  };\r\n\r\n  static apply = function (fit) {\r\n    const fitWithDomainID = Fit.#giveDomainID(fit);\r\n\r\n    const board = Fit.#createBoard(fitWithDomainID);\r\n    const staticBoard = Fit.#applyBoard_createStaticBoard(board);\r\n\r\n    return Fit.#applyBoard(fitWithDomainID, staticBoard);\r\n  };\r\n\r\n  static #applyBoard = function (fit, staticBoard) {\r\n    const ship = Fit.#applyBoard_type(fit.ship, staticBoard);\r\n    const miscSlots = Fit.#applyBoard_slots(fit.miscSlots, staticBoard);\r\n    const highSlots = Fit.#applyBoard_slots(fit.highSlots, staticBoard);\r\n    const midSlots = Fit.#applyBoard_slots(fit.midSlots, staticBoard);\r\n    const lowSlots = Fit.#applyBoard_slots(fit.lowSlots, staticBoard);\r\n    const rigSlots = Fit.#applyBoard_slots(fit.rigSlots, staticBoard);\r\n    const droneSlots = Fit.#applyBoard_slots(fit.droneSlots, staticBoard);\r\n\r\n    return {\r\n      ship,\r\n      miscSlots,\r\n      lowSlots,\r\n      midSlots,\r\n      highSlots,\r\n      rigSlots,\r\n      droneSlots,\r\n    };\r\n  };\r\n  static #applyBoard_createStaticBoard = function (board) {\r\n    const staticBoard = {};\r\n    const passiveBoard = Fit.#applyBoard_createPassiveBoard(board);\r\n\r\n    board.forEach((mod) => {\r\n      if (!staticBoard[mod.modifiedAttributeID])\r\n        staticBoard[mod.modifiedAttributeID] = [];\r\n      if (mod.isStatic === true) staticBoard[mod.modifiedAttributeID].push(mod);\r\n      else {\r\n        const appliedMod = Fit.#applyBoard_mod(mod, passiveBoard);\r\n        appliedMod[\"isStatic\"] = true;\r\n        staticBoard[mod.modifiedAttributeID].push(appliedMod);\r\n      }\r\n    });\r\n\r\n    return staticBoard;\r\n  };\r\n  static #applyBoard_createPassiveBoard = function (board) {\r\n    const passiveBoard = {};\r\n\r\n    board.forEach((mod) => {\r\n      if (!passiveBoard[mod.modifiedAttributeID])\r\n        passiveBoard[mod.modifiedAttributeID] = [];\r\n      passiveBoard[mod.modifiedAttributeID].push(mod);\r\n    });\r\n\r\n    return passiveBoard;\r\n  };\r\n  static #applyBoard_slots = function (slots, passiveBoard) {\r\n    return slots.map((slot) => {\r\n      const item = slot.item;\r\n      const charge = slot.charge;\r\n      return {\r\n        ...slot,\r\n        item: Fit.#applyBoard_type(item, passiveBoard),\r\n        charge: Fit.#applyBoard_type(charge, passiveBoard),\r\n      };\r\n    });\r\n  };\r\n  static #applyBoard_type = function (type, passiveBoard) {\r\n    if (!type || !type.typeAttributesStats) return type;\r\n\r\n    const typeAttributesStats = type.typeAttributesStats.map((attribute) => {\r\n      return Fit.#applyBoard_attribute(type, attribute, passiveBoard);\r\n    });\r\n\r\n    return { ...type, typeAttributesStats: typeAttributesStats };\r\n  };\r\n  static #applyBoard_attribute = function (type, attr, passiveBoard) {\r\n    const mods = passiveBoard[attr.attributeID];\r\n    if (!mods || mods.length === 0) return attr;\r\n\r\n    let value = attr.value;\r\n    let penCount = 0;\r\n    if (!!attr.debug || !!attr.falseDebug) console.log(\"ERROR\", \"debugCorrupt\");\r\n    const debug = [];\r\n    const falseDebug = [];\r\n\r\n    Fit.#applyBoard_sortMods(\r\n      mods.map((baseMod) => Fit.#applyBoard_mod(baseMod, passiveBoard))\r\n    ).forEach((mod) => {\r\n      if (Fit.#applyBoard_modIsTypeApplicable(type, mod)) {\r\n        const baseValue = value;\r\n        value = Fit.#common_operation(\r\n          value,\r\n          mod.modifyingAttributeValue,\r\n          mod.operation,\r\n          penCount\r\n        );\r\n        debug.push({\r\n          ...mod,\r\n          penCount,\r\n          values: {\r\n            baseValue: baseValue,\r\n            appliedValue: value,\r\n            penalizedModifyingAttributeValue: Fit.#common_penalizedModifyingValue(\r\n              mod.modifyingAttributeValue,\r\n              mod.operation,\r\n              penCount\r\n            ),\r\n          },\r\n        });\r\n        if (mod.isPenalized === true) penCount++;\r\n      } else falseDebug.push(mod);\r\n    });\r\n\r\n    return { ...attr, value: value, debug, falseDebug };\r\n  };\r\n  static #applyBoard_mod = function (mod, passiveBoard) {\r\n    if (\r\n      mod.modifyingAttributeID === mod.modifiedAttributeID ||\r\n      mod.isStatic === true\r\n    )\r\n      return mod;\r\n\r\n    const mods = passiveBoard[mod.modifyingAttributeID];\r\n    if (!mods || mods.length === 0) return mod;\r\n\r\n    let value = mod.modifyingAttributeValue;\r\n    let penCount = 0;\r\n    if (!!mod.debug || !!mod.falseDebug) console.log(\"ERROR\", \"debugCorrupt\");\r\n    const debug = [];\r\n    const falseDebug = [];\r\n\r\n    Fit.#applyBoard_sortMods(\r\n      mods.map((baseMod) => Fit.#applyBoard_mod(baseMod, passiveBoard))\r\n    ).forEach((appliedMod) => {\r\n      if (Fit.#applyBoard_modIsModApplicable(mod, appliedMod)) {\r\n        const baseValue = value;\r\n        value = Fit.#common_operation(\r\n          value,\r\n          appliedMod.modifyingAttributeValue,\r\n          appliedMod.operation,\r\n          penCount\r\n        );\r\n\r\n        debug.push({\r\n          ...appliedMod,\r\n          penCount,\r\n          values: {\r\n            baseValue: baseValue,\r\n            appliedValue: value,\r\n            penalizedModifyingAttributeValue: Fit.#common_penalizedModifyingValue(\r\n              appliedMod.modifyingAttributeValue,\r\n              appliedMod.operation,\r\n              penCount\r\n            ),\r\n          },\r\n        });\r\n        if (appliedMod.isPenalized === true) penCount++;\r\n      } else falseDebug.push(appliedMod);\r\n    });\r\n\r\n    return { ...mod, modifyingAttributeValue: value, debug, falseDebug };\r\n  };\r\n  static #applyBoard_sortMods = function (mods) {\r\n    const sampleMod = mods[0];\r\n\r\n    let compareFunc = () => true;\r\n    const highIsGood = sampleMod.modifiedAttributeHighIsGood;\r\n    if (highIsGood === true)\r\n      compareFunc = (a, b) => {\r\n        if (a.operation === b.operation)\r\n          return b.modifyingAttributeValue - a.modifyingAttributeValue;\r\n\r\n        if (a.operation === \"prePercent\" || a.operation === \"postPercent\")\r\n          return b.modifyingAttributeValue - a.modifyingAttributeValue - 1;\r\n\r\n        if (b.operation === \"prePercent\" || b.operation === \"postPercent\")\r\n          return 1 + b.modifyingAttributeValue - a.modifyingAttributeValue;\r\n      };\r\n    else if (highIsGood === false)\r\n      compareFunc = (a, b) => {\r\n        if (a.operation === b.operation)\r\n          return a.modifyingAttributeValue - b.modifyingAttributeValue;\r\n\r\n        if (a.operation === \"prePercent\" || a.operation === \"postPercent\")\r\n          return 1 + a.modifyingAttributeValue - b.modifyingAttributeValue;\r\n\r\n        if (b.operation === \"prePercent\" || b.operation === \"postPercent\")\r\n          return a.modifyingAttributeValue - b.modifyingAttributeValue - 1;\r\n      };\r\n    const modStackables = [];\r\n    const modNotStackables = [];\r\n    mods.forEach((mod) => {\r\n      if (\r\n        mod.operation === \"modAdd\" ||\r\n        mod.operation === \"modSub\" ||\r\n        mod.operation === \"postDiv\" ||\r\n        mod.isStackException === true\r\n      )\r\n        modStackables.push(mod);\r\n      else modNotStackables.push(mod);\r\n    });\r\n\r\n    const isModstackable = sampleMod.modifiedAttributeStackable;\r\n\r\n    if (isModstackable === false) {\r\n      modNotStackables.sort(compareFunc);\r\n      modNotStackables.forEach((mod, index, array) => {\r\n        array[index] = { ...mod, isPenalized: true };\r\n      });\r\n    }\r\n    return modStackables.concat(modNotStackables);\r\n  };\r\n  static #applyBoard_modIsModApplicable = function (targetMod, applyMod) {\r\n    if (!Fit.#applyBoard_modIsStateApplicable(applyMod)) {\r\n      /*  if (\r\n        !(\r\n          applyMod.typeState === \"activation\" &&\r\n          applyMod.effectCategory === \"overload\"\r\n        )\r\n      )\r\n        console.log(\r\n          \"STATE\",\r\n          `${applyMod.typeState} <-/- ${applyMod.effectCategory}`,\r\n          targetMod,\r\n          \"<-\",\r\n          applyMod\r\n        ); */ //TESTETS\r\n      return false;\r\n    }\r\n    switch (applyMod.domain) {\r\n      case \"itemID\":\r\n        switch (applyMod.func) {\r\n          case \"ItemModifier\":\r\n            return targetMod.domainID === applyMod.domainID;\r\n          /* default:\r\n            return false; */\r\n        }\r\n      case \"shipID\":\r\n        switch (applyMod.func) {\r\n          case \"ItemModifier\":\r\n            return targetMod.domainID === \"ship\";\r\n          case \"LocationGroupModifier\":\r\n            return targetMod.typeGroupID === applyMod.groupID;\r\n          case \"LocationRequiredSkillModifier\":\r\n            return targetMod?.typeSkills?.includes(applyMod.skillTypeID);\r\n          /* default:\r\n            return false; */\r\n        }\r\n      case \"charID\":\r\n        switch (applyMod.func) {\r\n          case \"OwnerRequiredSkillModifier\":\r\n            return targetMod?.typeSkills?.includes(applyMod.skillTypeID);\r\n        }\r\n      /*    case \"structureID\":\r\n        return false; */\r\n      default:\r\n        console.error(\"MOD_APPLICABLE_UNKNOWN\", targetMod, \"<-\", applyMod);\r\n        return false;\r\n    }\r\n  };\r\n  static #applyBoard_modIsTypeApplicable = function (type, mod) {\r\n    if (!Fit.#applyBoard_modIsStateApplicable(mod)) {\r\n      /* if (\r\n        !(mod.typeState === \"activation\" && mod.effectCategory === \"overload\")\r\n      )\r\n        console.log(\r\n          \"STATE\",\r\n          `${mod.typeState} <-/- ${mod.effectCategory}`,\r\n          type,\r\n          \"<-\",\r\n          mod\r\n        ); */ //TESTETS\r\n      return false;\r\n    }\r\n    if (type.domainID === undefined) console.log(\"domainID missing\", type);\r\n    switch (mod.domain) {\r\n      case \"itemID\":\r\n        switch (mod.func) {\r\n          case \"ItemModifier\":\r\n            return type.domainID === mod.domainID;\r\n          /* default:\r\n            return false; */\r\n        }\r\n      case \"shipID\":\r\n        switch (mod.func) {\r\n          case \"ItemModifier\":\r\n            return type.domainID === \"ship\";\r\n          case \"LocationGroupModifier\":\r\n            return type.groupID === mod.groupID;\r\n          case \"LocationRequiredSkillModifier\":\r\n            return (\r\n              !!type.typeSkills && type.typeSkills.includes(mod.skillTypeID)\r\n            );\r\n          /* default:\r\n            return false; */\r\n        }\r\n      case \"charID\":\r\n        switch (mod.func) {\r\n          case \"OwnerRequiredSkillModifier\":\r\n            return (\r\n              !!type.typeSkills && type.typeSkills.includes(mod.skillTypeID)\r\n            );\r\n          case \"ItemModifier\":\r\n            return true;\r\n          /* default:\r\n            return false; */\r\n        }\r\n      case \"otherID\":\r\n        switch (mod.func) {\r\n          case \"ItemModifier\":\r\n            return (\r\n              type.domainID.split(\".\")[0] === mod.domainID.split(\".\")[0] &&\r\n              type.domainID.split(\".\")[1] === mod.domainID.split(\".\")[1]\r\n            );\r\n          /* default:\r\n            return false; */\r\n        }\r\n      case \"structureID\":\r\n        return false;\r\n      default:\r\n        console.error(\"TYPE_APPLICABLE_UNKNOWN\", type, \"<-\", mod); //TESTETS\r\n        return false;\r\n    }\r\n  };\r\n  static #applyBoard_modIsStateApplicable = function (mod) {\r\n    switch (mod.typeState) {\r\n      case \"overload\":\r\n        return true;\r\n      case \"activation\":\r\n        switch (mod.effectCategory) {\r\n          case \"overload\":\r\n            return false;\r\n          default:\r\n            return true;\r\n        }\r\n      case \"passive\":\r\n        switch (mod.effectCategory) {\r\n          case \"overload\":\r\n          case \"target\":\r\n          case \"activation\":\r\n            return false;\r\n          default:\r\n            return true;\r\n        }\r\n      case \"offline\":\r\n        switch (mod.effectCategory) {\r\n          default:\r\n            return false;\r\n        }\r\n      default:\r\n        return false;\r\n    }\r\n  };\r\n\r\n  static #giveDomainID = function (fit) {\r\n    const skills = Fit.#giveDomainID_skills(fit.skills);\r\n    const ship = { ...fit.ship, domainID: \"ship\" };\r\n    const miscSlots = Fit.#giveDomainID_slots(fit.miscSlots, \"miscSlots\");\r\n    const lowSlots = Fit.#giveDomainID_slots(fit.lowSlots, \"lowSlots\");\r\n    const midSlots = Fit.#giveDomainID_slots(fit.midSlots, \"midSlots\");\r\n    const highSlots = Fit.#giveDomainID_slots(fit.highSlots, \"highSlots\");\r\n    const rigSlots = Fit.#giveDomainID_slots(fit.rigSlots, \"rigSlots\");\r\n    const droneSlots = Fit.#giveDomainID_slots(fit.droneSlots, \"droneSlots\");\r\n\r\n    return {\r\n      skills,\r\n      ship,\r\n      miscSlots,\r\n      lowSlots,\r\n      midSlots,\r\n      highSlots,\r\n      rigSlots,\r\n      droneSlots,\r\n    };\r\n  };\r\n  static #giveDomainID_slots = function (slots, slotName) {\r\n    if (!slots || slots.constructor !== Array) return undefined;\r\n\r\n    return slots.map((slot, index) => {\r\n      const item = !!slot.item.typeID\r\n        ? { ...slot.item, domainID: `${slotName}.${index}.item` }\r\n        : false;\r\n      const charge = !!slot.charge.typeID\r\n        ? { ...slot.charge, domainID: `${slotName}.${index}.charge` }\r\n        : false;\r\n      return { item, charge };\r\n    });\r\n  };\r\n  static #giveDomainID_skills = function (skillsBoard) {\r\n    if (!skillsBoard || skillsBoard.constructor !== Array) {\r\n      const dogmaSkills = skillsBoard;\r\n      return dogmaSkills;\r\n    } else if (skillsBoard[0].domainID !== undefined) {\r\n      const skillsStaticBoardPlane = skillsBoard;\r\n      return skillsStaticBoardPlane;\r\n    }\r\n    return skillsBoard.map((skill) => ({\r\n      ...skill,\r\n      domainID: `skill:${skill.typeName}`,\r\n    }));\r\n  };\r\n\r\n  static #createBoard = function (fit) {\r\n    // skills will be two type: skills(Object) or pre made skills_modifiers(Array)\r\n    const skills = Fit.#createBoard_skills(fit.skills);\r\n    const ship = Fit.#createBoard_singleType(fit.ship, true);\r\n    const miscSlots = Fit.#createBoard_slots(fit.miscSlots, true);\r\n    const lowSlots = Fit.#createBoard_slots(fit.lowSlots);\r\n    const midSlots = Fit.#createBoard_slots(fit.midSlots);\r\n    const highSlots = Fit.#createBoard_slots(fit.highSlots);\r\n    const rigSlots = Fit.#createBoard_slots(fit.rigSlots);\r\n    const droneSlots = Fit.#createBoard_slots(fit.droneSlots);\r\n\r\n    return [\r\n      ...skills,\r\n      ...ship,\r\n      ...miscSlots,\r\n      ...lowSlots,\r\n      ...midSlots,\r\n      ...highSlots,\r\n      ...rigSlots,\r\n      ...droneSlots,\r\n    ];\r\n  };\r\n  static #createBoard_slots = function (slots, isStackException = false) {\r\n    if (!slots || slots.constructor !== Array) return [];\r\n\r\n    const mods = [];\r\n    slots.forEach((slot) => {\r\n      const itemMods = Fit.#createBoard_singleType(slot.item, isStackException);\r\n      const chargeMods = Fit.#createBoard_singleType(slot.charge, true);\r\n      if (!!itemMods) itemMods.forEach((mod) => mods.push(mod));\r\n      if (!!chargeMods) chargeMods.forEach((mod) => mods.push(mod));\r\n    });\r\n\r\n    return mods;\r\n  };\r\n  static extractSkillsStaticPlaneBoard(dogmaSkills) {\r\n    if (dogmaSkills.constructor !== Object) return [];\r\n\r\n    const skillBoard = Fit.#createBoard_skills(dogmaSkills);\r\n    const skillsStaticBoardMax = Fit.#applyBoard_createStaticBoard(skillBoard);\r\n    const skillsStaticBoardMed = Object.values(skillsStaticBoardMax)\r\n      .reduce((acc, mods) => acc.concat(mods), [])\r\n      .map((mod) => ({ ...mod, debug: undefined, falseDebug: undefined }));\r\n\r\n    return skillsStaticBoardMed;\r\n  }\r\n  static #createBoard_skills = function (dogmaSkills) {\r\n    if (dogmaSkills.constructor === Array) {\r\n      const skillsBoard = dogmaSkills;\r\n      return skillsBoard;\r\n    }\r\n\r\n    return Object.values(dogmaSkills).reduce((acc, dogmaSkill) => {\r\n      const mods = Fit.#createBoard_singleType(dogmaSkill, true);\r\n      const board = mods.map((mod) => ({\r\n        ...mod,\r\n        domainID: `skill:${mod.typeName}`,\r\n      }));\r\n      return acc.concat(board);\r\n    }, []);\r\n  };\r\n  static #createBoard_singleType = function (type, isStackException = false) {\r\n    if (!type) return [];\r\n\r\n    // effectID: 132,effectName: \"skillEffect\",\r\n    const invalidEffectIDs = [132];\r\n    // ExtrovertEffect is effect have modifierInfo\r\n    // Existence of modifierInfo ensures effect affect anonymous attribute with given value\r\n    const extrovertEffects = !!type.typeEffectsStats\r\n      ? type.typeEffectsStats.filter(\r\n          (effect) =>\r\n            effect.modifierInfo !== undefined &&\r\n            !invalidEffectIDs.includes(effect.effectID)\r\n        )\r\n      : [];\r\n\r\n    const mods = [];\r\n    extrovertEffects.forEach((effect) => {\r\n      effect.modifierInfo.forEach((mod) => {\r\n        const modifyingAttribute = Fit.#common_findAttributeByID(\r\n          type,\r\n          mod.modifyingAttributeID\r\n        );\r\n        const modifyingAttributeValue = !!mod.modifyingAttributeValue\r\n          ? mod.modifyingAttributeValue\r\n          : modifyingAttribute?.value;\r\n\r\n        mods.push({\r\n          domainID: type.domainID,\r\n          typeName: type.typeName,\r\n          ...mod,\r\n          effectName: effect.effectName,\r\n          effectCategory: effect.effectCategory,\r\n          modifyingAttributeValue: modifyingAttributeValue,\r\n          typeID: type.typeID,\r\n          typeState: type.iconID !== 33 ? type.typeState : \"passive\",\r\n          typeGroupID: type.groupID,\r\n          typeSkills: type.typeSkills,\r\n          isStackException:\r\n            mod.isStackException !== undefined\r\n              ? mod.isStackException\r\n              : isStackException,\r\n        });\r\n      });\r\n    });\r\n\r\n    return mods;\r\n  };\r\n  static getCurrentState = function (type) {\r\n    return Fit.#createBoard_setState(type);\r\n  };\r\n  static getInitialState = function (type) {\r\n    if (!type || !type.typeEffectsStats) return undefined;\r\n    if (type.iconID === 33) return \"passive\"; // if type is skill\r\n\r\n    return type.typeEffectsStats.reduce((acc, efft) => {\r\n      if (\r\n        (efft.effectCategory === \"activation\" && efft.effectID !== 16) ||\r\n        efft.effectCategory === \"target\"\r\n      )\r\n        //effectCategory: \"activation\", effectID: 16, effectName: \"online\"\r\n        return \"activation\";\r\n\r\n      return acc;\r\n    }, \"passive\");\r\n  };\r\n  static #createBoard_setState = function (type) {\r\n    if (!type && type !== 0) return undefined;\r\n    if (!type.typeEffectsStats || type.iconID === 33) return \"passive\"; // if type is skill\r\n    const initialState = type.typeEffectsStats.reduce((acc, efft) => {\r\n      if (\r\n        (efft.effectCategory === \"activation\" && efft.effectID !== 16) ||\r\n        efft.effectCategory === \"target\"\r\n      )\r\n        //effectCategory: \"activation\", effectID: 16, effectName: \"online\"\r\n        return \"activation\";\r\n\r\n      return acc;\r\n    }, \"passive\");\r\n    const currentState = type.typeState;\r\n\r\n    if (currentState === undefined) return initialState;\r\n    if (initialState === \"passive\" && currentState === \"activation\")\r\n      return \"passive\";\r\n    return currentState;\r\n  };\r\n\r\n  static #common_findAttributeByID = function (type, attributeID) {\r\n    if (!type || !type.typeAttributesStats) return undefined;\r\n    if (type.typeAttributesStats.constructor !== Array) return undefined;\r\n\r\n    const attribute = type.typeAttributesStats.find(\r\n      (entry) => entry.attributeID === attributeID\r\n    );\r\n\r\n    return attribute;\r\n  };\r\n  static #common_operation = function (\r\n    baseValue,\r\n    applyValue,\r\n    operation,\r\n    penCount\r\n  ) {\r\n    //TODO: findout why does eve developers make shit like this typeID=31760 effect is weird\r\n    if (applyValue === undefined) return baseValue;\r\n\r\n    let value = baseValue;\r\n    switch (operation) {\r\n      case \"preMul\":\r\n      case \"postMul\":\r\n        value = Fit.#oepration_mul(baseValue, applyValue, penCount);\r\n        break;\r\n      case \"prePercent\":\r\n      case \"postPercent\":\r\n        value = Fit.#oepration_per(baseValue, applyValue, penCount);\r\n        break;\r\n      case \"modAdd\":\r\n        value = Fit.#operation_add(baseValue, applyValue);\r\n        break;\r\n      case \"modSub\":\r\n        value = Fit.#operation_sub(baseValue, applyValue);\r\n        break;\r\n      case \"postDiv\":\r\n        value = Fit.#operation_div(baseValue, applyValue);\r\n        break;\r\n      case \"postAssignment\":\r\n        return applyValue;\r\n      default:\r\n        break;\r\n    }\r\n    return value;\r\n  };\r\n  static #oepration_mul = function (baseValue, mulValue, penCount = 0) {\r\n    return baseValue * ((mulValue - 1) * Fit.#common_penaltyMul(penCount) + 1);\r\n  };\r\n  static #oepration_per = function (baseValue, perValue, penCount = 0) {\r\n    return (\r\n      baseValue * ((perValue / 100) * Fit.#common_penaltyMul(penCount) + 1)\r\n    );\r\n  };\r\n  static #operation_add = function (baseValue, addValue) {\r\n    return baseValue + addValue;\r\n  };\r\n  static #operation_sub = function (baseValue, subValue) {\r\n    return baseValue - subValue;\r\n  };\r\n  static #operation_div = function (baseValue, divValue) {\r\n    return baseValue / divValue;\r\n  };\r\n  static #common_penaltyMul = function (penCount) {\r\n    return Math.pow(Math.E, -0.140274 * penCount * penCount);\r\n  };\r\n  static #common_penalizedModifyingValue = function (\r\n    applyValue,\r\n    operation,\r\n    penCount\r\n  ) {\r\n    switch (operation) {\r\n      case \"preMul\":\r\n      case \"postMul\":\r\n        return 1 + Fit.#common_penaltyMul(penCount) * (applyValue - 1);\r\n      case \"prePercent\":\r\n      case \"postPercent\":\r\n        return Fit.#common_penaltyMul(penCount) * applyValue;\r\n      case \"modAdd\":\r\n      case \"modSub\":\r\n        return applyValue;\r\n      case \"postDiv\":\r\n        return applyValue / Fit.#common_penaltyMul(penCount);\r\n      default:\r\n        return applyValue;\r\n    }\r\n  };\r\n}\r\n","export default class EveMath {\r\n  static getAmbientChargeRateMath(Cmax, Cnow, Tchg) {\r\n    return ((10 * Cmax) / Tchg) * (Math.sqrt(Cnow / Cmax) - Cnow / Cmax) || 0;\r\n  }\r\n  static getTurretAcurracy(summary, owner, target) {\r\n    const onBoardVector = owner.summary.situation.vector;\r\n    const hostileVector = target.summary.situation.vector;\r\n    const distanceVector = {\r\n      x:\r\n        target.summary.situation.anchors.anchor1X -\r\n        owner.summary.situation.anchors.anchor1X,\r\n      y:\r\n        target.summary.situation.anchors.anchor1Y -\r\n        owner.summary.situation.anchors.anchor1Y,\r\n    };\r\n    const distance =\r\n      Math.sqrt(Math.pow(distanceVector.x, 2) + Math.pow(distanceVector.y, 2)) /\r\n      100;\r\n\r\n    const trackingValue =\r\n      summary.range.tracking * (40000 / summary.range.signatureResolution);\r\n    const signatureRadius = target.summary.capacity.misc.signatureRadius;\r\n\r\n    const _angularVelocity = EveMath.#getTurretAcurracy_angularVelocuty(\r\n      distance,\r\n      distanceVector,\r\n      onBoardVector,\r\n      hostileVector\r\n    );\r\n    const _trackingPart = EveMath.#getTurretAcurracy_trackingPart(\r\n      _angularVelocity,\r\n      trackingValue,\r\n      signatureRadius\r\n    );\r\n\r\n    const trackingModifier = Math.pow(0.5, _trackingPart);\r\n    const rangeModifier = EveMath.getRangeModifier(summary, owner, target);\r\n\r\n    return (trackingModifier * rangeModifier).toFixed(3);\r\n  }\r\n  static getLauncherAccuracy(summary, owner, target) {\r\n    const distanceVector = {\r\n      x:\r\n        target.summary.situation.anchors.anchor1X -\r\n        owner.summary.situation.anchors.anchor1X,\r\n      y:\r\n        target.summary.situation.anchors.anchor1Y -\r\n        owner.summary.situation.anchors.anchor1Y,\r\n    };\r\n    const distance =\r\n      Math.sqrt(Math.pow(distanceVector.x, 2) + Math.pow(distanceVector.y, 2)) /\r\n      100;\r\n\r\n    return summary.range.optimalRange < distance * 1000 ? 0 : 1;\r\n  }\r\n  static getDroneAccracy(summary, owner, target) {\r\n    // owner is owner of drone! which is ship\r\n    if (summary.isSentry)\r\n      return EveMath.getTurretAcurracy(summary, owner, target);\r\n\r\n    const targetUnitVector = EveMath.#common_makeUnitVector(\r\n      target.summary.situation.vector\r\n    );\r\n    const targetVelocity =\r\n      Math.sqrt(\r\n        Math.pow(target.summary.situation.vector.x, 2) +\r\n          Math.pow(target.summary.situation.vector.y, 2)\r\n      ) * 3;\r\n    const isChasing =\r\n      summary.capacity.propulsion.orbitVelocity < targetVelocity;\r\n    if (isChasing) {\r\n      const droneAccuracyModifier = EveMath.#getDroneAccracy_getAccuracyModifier(\r\n        summary,\r\n        targetVelocity\r\n      );\r\n      const absoluteVelocity = summary.capacity.propulsion.orbitVelocity;\r\n      const droneVector = {\r\n        x: targetUnitVector.x * (absoluteVelocity / 3), // Currently 1px = 3m/s\r\n        y: targetUnitVector.y * (absoluteVelocity / 3),\r\n      };\r\n      const droneSituationsummary = {\r\n        summary: {\r\n          situation: {\r\n            anchors: {\r\n              anchor1X:\r\n                target.summary.situation.anchors.anchor1X -\r\n                (targetUnitVector.x * summary.capacity.propulsion.orbitRange) /\r\n                  10, // Currently 1px = 10m\r\n              anchor1Y:\r\n                target.summary.situation.anchors.anchor1Y -\r\n                (targetUnitVector.y * summary.capacity.propulsion.orbitRange) /\r\n                  10,\r\n            },\r\n            vector: droneVector,\r\n          },\r\n        },\r\n      };\r\n      return (\r\n        EveMath.getTurretAcurracy(summary, droneSituationsummary, target) *\r\n        droneAccuracyModifier\r\n      );\r\n    } else {\r\n      const absoluteVelocity =\r\n        summary.capacity.propulsion.orbitVelocity + targetVelocity;\r\n      const droneVector = {\r\n        x: targetUnitVector.x * (absoluteVelocity / 3), // Currently 1px = 3m/s\r\n        y: targetUnitVector.y * (absoluteVelocity / 3),\r\n      }; // drone positions at perpendicular to targetVector\r\n      const droneSituationsummary = {\r\n        summary: {\r\n          situation: {\r\n            anchors: {\r\n              anchor1X:\r\n                target.summary.situation.anchors.anchor1X +\r\n                (targetUnitVector.y * summary.capacity.propulsion.orbitRange) /\r\n                  10, // Currently 1px = 10m\r\n              anchor1Y:\r\n                target.summary.situation.anchors.anchor1Y -\r\n                (targetUnitVector.x * summary.capacity.propulsion.orbitRange) /\r\n                  10,\r\n            },\r\n            vector: droneVector,\r\n          },\r\n        },\r\n      };\r\n      return EveMath.getTurretAcurracy(summary, droneSituationsummary, target);\r\n    }\r\n  }\r\n  static #getDroneAccracy_getAccuracyModifier = (summary, targetVelocity) => {\r\n    // Estimated modifier - drone movement is too complicated simplify the situation when target velocity is higher than orbit velocity\r\n    //prettier-ignore\r\n    const value = 1 -targetVelocity /\r\n          (summary.capacity.propulsion.maximumVelocity - summary.capacity.propulsion.orbitVelocity);\r\n    if (value >= 1) return 1;\r\n    return value >= 0 ? value : 0.01;\r\n  };\r\n  static getLauncherDamageModifier(summary, target) {\r\n    const signatureRadius = target.summary.capacity.misc.signatureRadius;\r\n    const explosionRadius = summary.range.explosionRadius;\r\n    const explosionVelocity = summary.range.explosionVelocity;\r\n    const damageReductionFactor = summary.range.damageReductionFactor;\r\n    const targetVelocity =\r\n      Math.sqrt(\r\n        Math.pow(target.summary.situation.vector.x, 2) +\r\n          Math.pow(target.summary.situation.vector.y, 2)\r\n      ) * 3;\r\n\r\n    const simplePart = signatureRadius / explosionRadius;\r\n    const complexPart = Math.pow(\r\n      (signatureRadius * explosionVelocity) /\r\n        (explosionRadius * targetVelocity),\r\n      damageReductionFactor\r\n    );\r\n\r\n    return Math.min(1, simplePart, complexPart);\r\n  }\r\n  static getTurretRandomDamageModifier() {\r\n    const randomDamageModifier = Math.random();\r\n    return randomDamageModifier < 0.01 ? 3 : randomDamageModifier + 0.49;\r\n  }\r\n  static getRangeModifier(summary, owner, target) {\r\n    const distanceVector = {\r\n      x:\r\n        target.summary.situation.anchors.anchor1X -\r\n        owner.summary.situation.anchors.anchor1X,\r\n      y:\r\n        target.summary.situation.anchors.anchor1Y -\r\n        owner.summary.situation.anchors.anchor1Y,\r\n    };\r\n    const distance =\r\n      Math.sqrt(Math.pow(distanceVector.x, 2) + Math.pow(distanceVector.y, 2)) /\r\n      100;\r\n\r\n    const optimal = summary.range.optimalRange;\r\n    const falloff = summary.range.falloffRange;\r\n    if (distance * 1000 > optimal + 3 * falloff) return 0;\r\n\r\n    const denominator = falloff;\r\n    const numerator = Math.max(0, distance * 1000 - optimal);\r\n    const _distancePart = Math.pow(numerator / denominator, 2);\r\n\r\n    return Math.pow(0.5, _distancePart);\r\n  }\r\n\r\n  static #getTurretAcurracy_trackingPart = (\r\n    angularVelocity,\r\n    trackingValue,\r\n    signatureRadius\r\n  ) => {\r\n    const denominator = trackingValue * signatureRadius;\r\n    const numerator = angularVelocity * 40000;\r\n    return Math.pow(numerator / denominator, 2);\r\n  };\r\n  static #getTurretAcurracy_distancePart = (optimal, fallOff, distance) => {\r\n    const denominator = fallOff;\r\n    const numerator = Math.max(0, distance * 1000 - optimal);\r\n    return Math.pow(numerator / denominator, 2);\r\n  };\r\n  static #getTurretAcurracy_angularVelocuty = (\r\n    distance,\r\n    distanceVector,\r\n    onBoardVector,\r\n    hostileVector\r\n  ) => {\r\n    if (\r\n      EveMath.#getTurretAcurracy_validateVector(distanceVector) &&\r\n      EveMath.#getTurretAcurracy_validateVector(onBoardVector) &&\r\n      EveMath.#getTurretAcurracy_validateVector(hostileVector)\r\n    ) {\r\n      const perpendicularVector = { x: -distanceVector.y, y: distanceVector.x };\r\n      const perpendicularUnitVector = EveMath.#common_makeUnitVector(\r\n        perpendicularVector\r\n      );\r\n      const hostileOrbitalVelocity = EveMath.#getTurretAcurracy_innerProduct(\r\n        perpendicularUnitVector,\r\n        hostileVector\r\n      );\r\n      const onBoardOrbitalVelocity = EveMath.#getTurretAcurracy_innerProduct(\r\n        perpendicularUnitVector,\r\n        onBoardVector\r\n      );\r\n      const trueObitalVelocity =\r\n        (hostileOrbitalVelocity - onBoardOrbitalVelocity) * 3;\r\n      return trueObitalVelocity / (distance * 1000);\r\n    } else return false;\r\n  };\r\n  static #getTurretAcurracy_innerProduct = (unitVector, velocityVector) => {\r\n    return unitVector.x * velocityVector.x + unitVector.y * velocityVector.y;\r\n  };\r\n  static #getTurretAcurracy_validateVector = (vector) => {\r\n    if (vector.x !== undefined && vector.y !== undefined) return true;\r\n    else return false;\r\n  };\r\n  static #common_makeUnitVector = (vector) => {\r\n    const length = Math.sqrt(Math.pow(vector.x, 2) + Math.pow(vector.y, 2));\r\n    return { x: vector.x / length, y: vector.y / length };\r\n  };\r\n}\r\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nexport default function _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","import _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nexport default function _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  }\n\n  return assertThisInitialized(self);\n}","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","import getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport isNativeReflectConstruct from \"@babel/runtime/helpers/esm/isNativeReflectConstruct\";\nimport possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nexport default function _createSuper(Derived) {\n  var hasNativeReflectConstruct = isNativeReflectConstruct();\n  return function _createSuperInternal() {\n    var Super = getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = getPrototypeOf(this).constructor;\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return possibleConstructorReturn(this, result);\n  };\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","export function findAttributesByName(item, attributeName) {\r\n  if (!item || !item.typeAttributesStats) return undefined;\r\n\r\n  if (attributeName.constructor === String) {\r\n    return findAttributeByName(item, attributeName);\r\n  } else if (attributeName.constructor === Array) {\r\n    const attributes = attributeName.map((entry) =>\r\n      findAttributeByName(item, entry)\r\n    );\r\n\r\n    if (attributes.length === 0) return undefined;\r\n    return attributes;\r\n  }\r\n}\r\n\r\nfunction findAttributeByName(item, attributeName) {\r\n  if (!item || !item.typeAttributesStats) return undefined;\r\n\r\n  if (item.typeAttributesStats.constructor !== Array) return undefined;\r\n\r\n  const result = item.typeAttributesStats.filter(\r\n    (entry) => entry.attributeName === attributeName\r\n  );\r\n\r\n  if (result.length === 1) return result[0].value;\r\n  if (result.length >= 2) return result.map((entry) => entry.value);\r\n  else return undefined;\r\n}\r\n\r\nexport function findAttributesbyID(item, attributeID) {\r\n  if (!item || !item.typeAttributesStats) return undefined;\r\n\r\n  if (attributeID.constructor === Number) {\r\n    return findAttributebyID(item, attributeID);\r\n  } else if (attributeID.constructor === Array) {\r\n    const attributes = attributeID.map((entry) =>\r\n      findAttributebyID(item, entry)\r\n    );\r\n\r\n    if (attributes.length === 0) return undefined;\r\n    return attributes;\r\n  }\r\n}\r\n\r\nexport function findAttributebyID(item, attributeID) {\r\n  if (!item || !item.typeAttributesStats) return undefined;\r\n\r\n  if (item.typeAttributesStats.constructor !== Array) return undefined;\r\n\r\n  const result = item.typeAttributesStats.filter(\r\n    (entry) => entry.attributeID === attributeID\r\n  );\r\n\r\n  if (result.length === 1) return result[0].value;\r\n  else if (result.length >= 2) return result.map((entry) => entry.value);\r\n  else return undefined;\r\n}\r\n","import { findAttributebyID } from \"../../../../services/dataManipulation/findAttributes\";\r\nimport Fit from \"../../../../fitter/src/Fit\";\r\n\r\nexport default class Stat {\r\n  static defaultStat = {\r\n    damage: {\r\n      turretLauncherDamage: { max: 0, effective: 0, alpha: 0 },\r\n      turretLauncherRange: [],\r\n      droneDamage: { max: 0, effective: 0, alpha: 0 },\r\n    },\r\n    defense: {\r\n      resistance: {\r\n        armor: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n        shield: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n        structure: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n      },\r\n      active: {\r\n        shieldBonus: 0,\r\n        armorBonus: 0,\r\n        structureBonus: 0,\r\n      },\r\n    },\r\n    capacitor: {\r\n      ambientChargeRate: 0,\r\n      boosterChargeRate: 0,\r\n      activationUseRate: 0,\r\n      stableLevel: 0,\r\n    },\r\n    resource: {\r\n      capacity: {\r\n        turret: 0,\r\n        launcher: 0,\r\n        calibration: 0,\r\n        droneBandwidth: 0,\r\n        droneBay: 0,\r\n        droneActive: 5,\r\n      },\r\n      load: {\r\n        turret: 0,\r\n        launcher: 0,\r\n        calibration: 0,\r\n        droneBandwidth: 0,\r\n        droneBay: 0,\r\n        droneActive: 0,\r\n      },\r\n    },\r\n    engineering: {\r\n      pg: { load: 0, output: 0 },\r\n      cpu: { load: 0, output: 0 },\r\n    },\r\n    miscellaneous: {\r\n      sensor: {\r\n        scanResolution: 0,\r\n        maximumLockedTarget: 0,\r\n        maximumTargetingRange: 0,\r\n        strength: {\r\n          gravimetric: 0,\r\n          magnetometric: 0,\r\n          ladar: 0,\r\n          radar: 0,\r\n        },\r\n      },\r\n      propulsion: {\r\n        inertialModifier: 0,\r\n        maximumVelocity: 0,\r\n        warpSpeedMultiplier: 0,\r\n      },\r\n      misc: {\r\n        cargoBayCapacity: 0,\r\n        signatureRadius: 0,\r\n      },\r\n    },\r\n  };\r\n  static stat(fit) {\r\n    const propCapacitor = Stat.capacitor(fit);\r\n\r\n    return {\r\n      damage: Stat.damage(fit),\r\n      defense: Stat.defense(fit),\r\n      capacitor: {\r\n        ...propCapacitor,\r\n        stableLevel: Stat.capacitor_stableLevel(fit, propCapacitor),\r\n      },\r\n      engineering: Stat.engineering(fit),\r\n      resource: Stat.resource(fit),\r\n      miscellaneous: Stat.miscellaneous(fit),\r\n    };\r\n  }\r\n\r\n  static damage(fit) {\r\n    if (!fit.highSlots)\r\n      return {\r\n        turretLauncherDamage: { max: 0, effective: 0, alpha: 0 },\r\n        turretLauncherRange: [],\r\n        droneDamage: { max: 0, effective: 0, alpha: 0 },\r\n      };\r\n\r\n    const turrets = Stat.#damage_turrets(fit);\r\n    const launchers = Stat.#damage_launchers(fit);\r\n    const drones = Stat.#damage_drones(fit);\r\n\r\n    const turretLauncherDamageSlots = [...turrets, ...launchers];\r\n    const turretLauncherDamageSummaries = turretLauncherDamageSlots.map(\r\n      (slot) => {\r\n        return Stat.damage_getSummary(slot.item, slot.charge);\r\n      }\r\n    );\r\n    const turretLauncherDamage = turretLauncherDamageSummaries.reduce(\r\n      (acc, summary) => {\r\n        const alpha = summary.damagePerAct.alpha;\r\n        const maxDps = alpha / summary.activationInfo.duration || 0;\r\n        const effectiveDps = alpha / summary.activationInfo.e_duration || 0;\r\n\r\n        return {\r\n          max: acc.max + maxDps,\r\n          effective: acc.effective + effectiveDps,\r\n          alpha: acc.alpha + alpha,\r\n        };\r\n      },\r\n      { max: 0, effective: 0, alpha: 0 }\r\n    );\r\n\r\n    const turretLauncherRange = turretLauncherDamageSummaries.reduce(\r\n      (acc, summary) => {\r\n        const optimalRange = summary.range.optimalRange;\r\n        const falloffRange = summary.range.falloffRange;\r\n\r\n        const overlappingRange = acc.find(\r\n          (range) =>\r\n            range.optimalRange === optimalRange &&\r\n            range.falloffRange === falloffRange\r\n        );\r\n        if (!!overlappingRange) overlappingRange.debug.push(summary.slot);\r\n        else acc.push({ optimalRange, falloffRange, debug: [summary.slot] });\r\n        return acc;\r\n      },\r\n      []\r\n    );\r\n\r\n    const droneSummaries = drones.map((drone) => {\r\n      return Stat.damage_getSummary(drone.item, drone.item);\r\n    });\r\n    const droneDamage = droneSummaries.reduce(\r\n      (acc, summary) => {\r\n        const typeCount = summary.typeCount;\r\n        const alpha = summary.damagePerAct.alpha;\r\n        const maxDps = alpha / summary.activationInfo.duration || 0;\r\n        const effectiveDps = alpha / summary.activationInfo.e_duration || 0;\r\n        return {\r\n          max: acc.max + maxDps * typeCount,\r\n          effective: acc.effective + effectiveDps,\r\n          alpha: acc.alpha + alpha,\r\n        };\r\n      },\r\n      { max: 0, effective: 0, alpha: 0 }\r\n    );\r\n\r\n    const damageSummaries = [\r\n      ...turretLauncherDamageSummaries,\r\n      ...droneSummaries,\r\n    ];\r\n\r\n    return {\r\n      turretLauncherDamage,\r\n      turretLauncherRange,\r\n      droneDamage,\r\n      damageSummaries,\r\n    };\r\n  }\r\n  static #damage_turrets = (fit) => {\r\n    return Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        const isTurretFitted = !!slot?.item?.typeEffectsStats?.find(\r\n          (efft) => efft.effectID === 42\r\n        ); //effectID: 42, effectName: \"turretFitted\"\r\n        const isActivated = slot.item.typeState === \"activation\";\r\n        if (isTurretFitted && Fit.validateChargeSlot(slot) && isActivated)\r\n          return slot;\r\n        else return undefined;\r\n      },\r\n      { isIterate: { highSlots: true } }\r\n    ).filter((slot) => !!slot);\r\n  };\r\n  static #damage_launchers = (fit) => {\r\n    return Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        const isLauncherFitted = !!slot?.item?.typeEffectsStats?.find(\r\n          (efft) => efft.effectID === 40\r\n        ); //effectID: 40, effectName: \"launcherFitted\"\r\n        const isActivated = slot.item.typeState === \"activation\";\r\n        if (isLauncherFitted && Fit.validateChargeSlot(slot) && isActivated)\r\n          return slot;\r\n        else return undefined;\r\n      },\r\n      { isIterate: { highSlots: true } }\r\n    ).filter((slot) => !!slot);\r\n  };\r\n  static #damage_drones = (fit) => {\r\n    return Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        const isActivated = slot.item.typeState === \"activation\";\r\n        if (isActivated) return slot;\r\n        else return undefined;\r\n      },\r\n      { isIterate: { droneSlots: true } }\r\n    ).filter((slot) => !!slot);\r\n  };\r\n  static damage_getSummary = (item, charge) => {\r\n    if (!item) return false;\r\n\r\n    const damagePerAct = Stat.damage_damagePerAct(item, charge);\r\n    const activationInfo = Stat.getActivationInfo(item, charge);\r\n    const range = Stat.damage_range(item, charge);\r\n    const typeCount = item.typeCount;\r\n    const slot = { item, charge };\r\n\r\n    return { activationInfo, damagePerAct, range, typeCount, slot };\r\n  };\r\n  static damage_damagePerAct = (item, charge) => {\r\n    const damageModifier = findAttributebyID(item, 64) || 1; //attributeID: 64, attributeName: \"Damage Modifier\"\r\n\r\n    const EM_damage = findAttributebyID(charge, 114); //attributeID: 114, attributeName: \"EM damage\"\r\n    const TH_damage = findAttributebyID(charge, 118); //attributeID: 118, attributeName: \"Thermal damage\"\r\n    const KI_damage = findAttributebyID(charge, 117); //attributeID: 117, attributeName: \"Kinetic damage\"\r\n    const EX_damage = findAttributebyID(charge, 116); //attributeID: 116, attributeName: \"Explosive damage\"\r\n    const mergedDamage = EM_damage + TH_damage + KI_damage + EX_damage;\r\n\r\n    const alpha = damageModifier * mergedDamage;\r\n\r\n    return {\r\n      alpha,\r\n      EM: EM_damage * damageModifier,\r\n      TH: TH_damage * damageModifier,\r\n      KI: KI_damage * damageModifier,\r\n      EX: EX_damage * damageModifier,\r\n    };\r\n  };\r\n  static damage_range = (item, charge) => {\r\n    const isTurretFitted = !!item?.typeEffectsStats?.find(\r\n      (efft) => efft.effectID === 42\r\n    ); //effectID: 42, effectName: \"turretFitted\"\r\n    const isLauncherFitted = !!item?.typeEffectsStats?.find(\r\n      (efft) => efft.effectID === 40\r\n    ); //effectID: 40, effectName: \"launcherFitted\"\r\n    const isDrone = item?.typeDroneSize !== undefined;\r\n\r\n    if (isTurretFitted || isDrone) {\r\n      const optimalRange = findAttributebyID(item, 54); //attributeID: 54, attributeName: \"Optimal Range\"\r\n      const falloffRange = findAttributebyID(item, 158); //attributeID: 158, attributeName: \"Accuracy falloff \"\r\n      const tracking = findAttributebyID(item, 160); // attributeID: 160, attributeName: \"Turret Tracking\"\r\n      const signatureResolution = findAttributebyID(item, 620); // attributeID: 620, attributeName: \"Signature Resolution\"\r\n\r\n      return { optimalRange, falloffRange, tracking, signatureResolution };\r\n    } else if (isLauncherFitted) {\r\n      const maximumVelocity = findAttributebyID(charge, 37); //attributeID: 37, attributeName: \"Maximum Velocity\"\r\n      const filghtTime = findAttributebyID(charge, 281); //attributeID: 281, attributeName: \"Maximum Flight Time\"\r\n      const optimalRange = maximumVelocity * (filghtTime / 1000);\r\n      const explosionVelocity = findAttributebyID(charge, 653); // attributeID: 653, attributeName: \"Explosion Velocity\"\r\n      const explosionRadius = findAttributebyID(charge, 654); // attributeID: 654, attributeName: \"Explosion Radius\"\r\n      const damageReductionFactor = findAttributebyID(charge, 1353); // attributeID: 1353, attributeName: \"aoeDamageReductionFactor\"\r\n\r\n      //prettier-ignore\r\n      return { optimalRange, falloffRange: 0, explosionVelocity, explosionRadius, damageReductionFactor };\r\n    } else return { optimalRange: 0, falloffRange: 0 };\r\n  };\r\n\r\n  static capacitor(fit) {\r\n    if (!fit)\r\n      return {\r\n        ambientChargeRate: 0,\r\n        boosterChargeRate: 0,\r\n        activationUseRate: 0,\r\n      };\r\n    const debug = [];\r\n    const slots = Fit.mapSlots(fit, (slot) => slot, {\r\n      isIterate: {\r\n        highSlots: true,\r\n        midSlots: true,\r\n        lowSlots: true,\r\n      },\r\n    });\r\n    const activationUseRate = slots.reduce((acc, slot) => {\r\n      const cus = Stat.#capacitor_getUseRate(slot);\r\n      if (cus > 0)\r\n        debug.push({\r\n          typeName: slot.item.typeName,\r\n          capacitorUsePerSec: cus,\r\n          dominID: slot.item.domainID,\r\n        });\r\n      return acc + cus;\r\n    }, 0);\r\n    const ambientChargeRate = Stat.#capacitor_getAmbientChargeRate(fit, 25);\r\n    const boosterChargeRate = Stat.#capacitor_getBoosterChargeRate(fit);\r\n    debug.push({ activationUseRate, ambientChargeRate, boosterChargeRate });\r\n\r\n    /* console.log(debug) */\r\n    return { ambientChargeRate, boosterChargeRate, activationUseRate };\r\n  }\r\n  static capacitor_stableLevel(fit, propCapacitor = false) {\r\n    if (!fit.ship?.typeID) return 0;\r\n    const capacitor = !!propCapacitor ? propCapacitor : Stat.capacitor(fit);\r\n    const Cmax = findAttributebyID(fit.ship, 482); //attributeID: 482, attributeName: \"Capacitor Capacity\"\r\n    const Tnow = findAttributebyID(fit.ship, 55) / 1000; //attributeID: 55, attributeName: \"Capacitor Recharge time\"\r\n\r\n    const capacitorDeltas = [];\r\n    for (let i = 200; i < 1000 + 1; i++) {\r\n      const Cnow = Cmax * (i / 1000);\r\n      capacitorDeltas.push({\r\n        capacitorLevel: i / 10,\r\n        delta:\r\n          Stat.getAmbientChargeRateMath(Cmax, Cnow, Tnow) +\r\n          capacitor.boosterChargeRate -\r\n          capacitor.activationUseRate,\r\n      });\r\n    }\r\n    const positiveDeltas = capacitorDeltas\r\n      .sort((a, b) => a.delta - b.delta)\r\n      .filter((capacitorDelta) => capacitorDelta.delta >= 0);\r\n\r\n    if (positiveDeltas[0] === undefined) return 0;\r\n    else return positiveDeltas[0].capacitorLevel;\r\n  }\r\n  static #capacitor_getUseRate = (slot) => {\r\n    if (slot.item.typeState !== \"activation\") return 0;\r\n\r\n    const activationCost = findAttributebyID(slot.item, 6); // attributeID: 6, attributeName: \"Activation Cost\"\r\n    if (activationCost === undefined) return 0;\r\n\r\n    const activationInfo = Stat.getActivationInfo(slot.item, slot.charge);\r\n\r\n    return activationCost / activationInfo.e_duration;\r\n  };\r\n  static #capacitor_getAmbientChargeRate = (fit, capacitorLevel) => {\r\n    const chargeInfo = Stat.capacitor_getChargeInfo(fit);\r\n    const Cmax = chargeInfo.HP;\r\n    const Tchg = chargeInfo.bonusRate;\r\n    const Cnow = (Cmax * capacitorLevel) / 100;\r\n\r\n    return Stat.getAmbientChargeRateMath(Cmax, Cnow, Tchg);\r\n  };\r\n  static capacitor_getChargeInfo = (fit) => {\r\n    const HP = findAttributebyID(fit.ship, 482) || 0; //attributeID: 482, attributeName: \"Capacitor Capacity\"\r\n    const bonusRate = findAttributebyID(fit.ship, 55) / 1000 || 0; //attributeID: 55, attributeName: \"Capacitor Recharge time\"\r\n\r\n    return { HP, bonusRate };\r\n  };\r\n  static #capacitor_getBoosterChargeRate = (fit) => {\r\n    const slots = Fit.mapSlots(fit, (slot) => slot, {\r\n      isIterate: { midSlots: true },\r\n    });\r\n    const boosterSlots = slots.filter((slot) => {\r\n      if (!slot?.item?.typeEffectsStats) return false;\r\n      return slot.item.typeEffectsStats.find((efft) => efft.effectID === 48); // effectID: 48, effectName: \"powerBooster\"\r\n    });\r\n\r\n    return boosterSlots.reduce((acc, boosterSlot) => {\r\n      //prettier-ignore\r\n      const activationInfo = Stat.getActivationInfo(boosterSlot.item, boosterSlot.charge);\r\n      //prettier-ignore\r\n      const capacitorBonus = Stat.capacitor_getBonusPerAct_self(boosterSlot.item, boosterSlot.charge);\r\n      const boostChargeRate = capacitorBonus / activationInfo.e_duration || 0;\r\n\r\n      return acc + boostChargeRate;\r\n    }, 0);\r\n  };\r\n  static capacitor_getBonusPerAct_self(item, charge) {\r\n    if (!item || !charge) return { capacitorBonus: 0 };\r\n\r\n    const bonusPerAct = findAttributebyID(charge, 67); //attributeID: 67, attributeName: \"Capacitor Bonus\"\r\n\r\n    return bonusPerAct;\r\n  }\r\n\r\n  static defense(fit) {\r\n    if (!fit || !fit.ship)\r\n      return {\r\n        resistance: {\r\n          armor: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n          shield: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n          structure: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n        },\r\n        active: {\r\n          shieldBonus: 0,\r\n          armorBonus: 0,\r\n          structureBonus: 0,\r\n        },\r\n      };\r\n    return {\r\n      resistance: Stat.defense_resistance(fit),\r\n      active: Stat.#defense_active(fit),\r\n    };\r\n  }\r\n  static defense_resistance = (fit) => {\r\n    if (!fit.ship || !fit.ship.typeAttributesStats)\r\n      return {\r\n        armor: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n        shield: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n        structure: { HP: 0, EM: 0, TH: 0, KI: 0, EX: 0 },\r\n      };\r\n\r\n    const shipAttrs = fit.ship.typeAttributesStats;\r\n\r\n    const armorHP = shipAttrs.find((attr) => attr.attributeID === 265);\r\n    const armorEM = shipAttrs.find((attr) => attr.attributeID === 267);\r\n    const armorTH = shipAttrs.find((attr) => attr.attributeID === 270);\r\n    const armorKI = shipAttrs.find((attr) => attr.attributeID === 269);\r\n    const armorEX = shipAttrs.find((attr) => attr.attributeID === 268);\r\n\r\n    const shieldHP = shipAttrs.find((attr) => attr.attributeID === 263);\r\n    const shieldEM = shipAttrs.find((attr) => attr.attributeID === 271);\r\n    const shieldTH = shipAttrs.find((attr) => attr.attributeID === 274);\r\n    const shieldKI = shipAttrs.find((attr) => attr.attributeID === 273);\r\n    const shieldEX = shipAttrs.find((attr) => attr.attributeID === 272);\r\n    const shieldChargeRate =\r\n      shipAttrs.find((attr) => attr.attributeID === 479).value / 1000 || 0; // attributeID: 479, attributeName: \"Shield recharge time\"\r\n\r\n    const structureHP = shipAttrs.find((attr) => attr.attributeID === 9);\r\n    const structureEM = shipAttrs.find((attr) => attr.attributeID === 113);\r\n    const structureTH = shipAttrs.find((attr) => attr.attributeID === 110);\r\n    const structureKI = shipAttrs.find((attr) => attr.attributeID === 109);\r\n    const structureEX = shipAttrs.find((attr) => attr.attributeID === 111);\r\n\r\n    return {\r\n      armor: {\r\n        HP: armorHP.value,\r\n        EM: Stat.#defense_resistance_decimal_fix(armorEM),\r\n        TH: Stat.#defense_resistance_decimal_fix(armorTH),\r\n        KI: Stat.#defense_resistance_decimal_fix(armorKI),\r\n        EX: Stat.#defense_resistance_decimal_fix(armorEX),\r\n      },\r\n      shield: {\r\n        HP: shieldHP.value,\r\n        EM: Stat.#defense_resistance_decimal_fix(shieldEM),\r\n        TH: Stat.#defense_resistance_decimal_fix(shieldTH),\r\n        KI: Stat.#defense_resistance_decimal_fix(shieldKI),\r\n        EX: Stat.#defense_resistance_decimal_fix(shieldEX),\r\n        bonusRate: shieldChargeRate,\r\n      },\r\n      structure: {\r\n        HP: structureHP.value,\r\n        EM: Stat.#defense_resistance_decimal_fix(structureEM),\r\n        TH: Stat.#defense_resistance_decimal_fix(structureTH),\r\n        KI: Stat.#defense_resistance_decimal_fix(structureKI),\r\n        EX: Stat.#defense_resistance_decimal_fix(structureEX),\r\n      },\r\n    };\r\n  };\r\n  static #defense_resistance_decimal_fix = (attr) => {\r\n    const value = 100 - attr.value * 100;\r\n    return value > 0 ? value : 0;\r\n  };\r\n  static defense_getSummary = (item, charge) => {\r\n    if (!item) return false;\r\n\r\n    const activationInfo = Stat.getActivationInfo(item, charge);\r\n    const bonusPerAct = Stat.defense_getBonusPerAct(item, charge);\r\n    const slot = { item, charge };\r\n\r\n    return { activationInfo, bonusPerAct, slot };\r\n  };\r\n  static defense_getBonusPerAct = (item, charge) => {\r\n    if (!item) return { shieldBonus: 0, armorBonus: 0, structureBonus: 0 };\r\n\r\n    const shield = findAttributebyID(item, 68) || 0; //attributeID: 68, attributeName: \"Shield Bonus\"\r\n    const armor = findAttributebyID(item, 84) || 0; //attributeID: 84, attributeName: \"Armor Hitpoints Repaired\"\r\n    const structure = findAttributebyID(item, 83) || 0; //attributeID: 83, attributeName: \"Structure Hitpoints Repaired\"\r\n\r\n    return { shield, armor, structure };\r\n  };\r\n  static #defense_active = (fit) => {\r\n    const active = {\r\n      shieldBonus: 0,\r\n      armorBonus: 0,\r\n      structureBonus: 0,\r\n    };\r\n    if (!fit.ship || !fit.ship.typeAttributesStats) return active;\r\n\r\n    Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        if (!slot.item.typeAttributesStats) return;\r\n        const activationTime = findAttributebyID(slot.item, 73); //attributeID: 73, attributeName: \"Activation time / duration\"\r\n\r\n        const shieldBonus = findAttributebyID(slot.item, 68); //attributeID: 68, attributeName: \"Shield Bonus\"\r\n        if (!!shieldBonus) {\r\n          active.shieldBonus += (shieldBonus / activationTime) * 1000;\r\n          return;\r\n        }\r\n        const armorBonus = findAttributebyID(slot.item, 84); //attributeID: 84, attributeName: \"Armor Hitpoints Repaired\"\r\n        if (!!armorBonus) {\r\n          active.armorBonus += (armorBonus / activationTime) * 1000;\r\n          return;\r\n        }\r\n        const structureBonus = findAttributebyID(slot.item, 83); //attributeID: 83, attributeName: \"Structure Hitpoints Repaired\"\r\n        if (!!structureBonus) {\r\n          active.structureBonus += (structureBonus / activationTime) * 1000;\r\n          return;\r\n        }\r\n      },\r\n      {\r\n        isIterate: { midSlots: true, lowSlots: true },\r\n      }\r\n    );\r\n    return active;\r\n  };\r\n\r\n  static engineering(fit) {\r\n    if (!fit.ship?.typeID)\r\n      return {\r\n        pg: { load: 0, output: 0 },\r\n        cpu: { load: 0, output: 0 },\r\n      };\r\n\r\n    const pgLoad = findAttributebyID(fit.ship, 15); // attributeID: 15, attributeName: \"Power Load\"\r\n    const pgOutput = findAttributebyID(fit.ship, 11); //attributeID: 11, attributeName: \"Powergrid Output\"\r\n    const cpuLoad = findAttributebyID(fit.ship, 49); // attributeID: 49, attributeName: \"CPU Load\"\r\n    const cpuOutput = findAttributebyID(fit.ship, 48); //attributeID: 48, attributeName: \"CPU Output\"\r\n\r\n    return {\r\n      pg: { load: Number(pgLoad.toFixed(1)), output: pgOutput },\r\n      cpu: { load: Number(cpuLoad.toFixed(1)), output: cpuOutput },\r\n    };\r\n  }\r\n\r\n  static resource(fit) {\r\n    if (!fit.ship || !fit.ship.typeAttributesStats)\r\n      return {\r\n        capacity: {\r\n          turret: 0,\r\n          launcher: 0,\r\n          calibration: 0,\r\n          droneBandwidth: 0,\r\n          droneBay: 0,\r\n          droneActive: 5,\r\n        },\r\n        load: {\r\n          turret: 0,\r\n          launcher: 0,\r\n          calibration: 0,\r\n          droneBandwidth: 0,\r\n          droneBay: 0,\r\n          droneActive: 0,\r\n        },\r\n      };\r\n\r\n    const turretHardpoint = findAttributebyID(fit.ship, 102); //attributeID: 102, attributeName: \"Turret Hardpoints\"\r\n    const launcherHardpoint = findAttributebyID(fit.ship, 101); //attributeID: 101, attributeName: \"Launcher Hardpoints\";\r\n    const calibration = findAttributebyID(fit.ship, 1132); //attributeID: 1132, attributeName: \"Calibration\"\r\n    const droneCapacity = findAttributebyID(fit.ship, 283); //attributeID: 283, attributeName: \"Drone Capacity\"\r\n    const droneBandwidth = findAttributebyID(fit.ship, 1271); //ttributeID: 1271, attributeName: \"Drone Bandwidth\"\r\n\r\n    const mountedTurrets = fit.highSlots.reduce((acc, slot) => {\r\n      const isTurretFitted = !!slot?.item?.typeEffectsStats?.find(\r\n        (efft) => efft.effectID === 42\r\n      ); //effectID: 42, effectName: \"turretFitted\"\r\n      return isTurretFitted && slot.item.typeState !== \"offline\" ? ++acc : acc;\r\n    }, 0);\r\n    const mountedLaunchers = fit.highSlots.reduce((acc, slot) => {\r\n      const isLauncherFitted = !!slot?.item?.typeEffectsStats?.find(\r\n        (efft) => efft.effectID === 40\r\n      ); //effectID: 40, effectName: \"launcherFitted\"\r\n      return isLauncherFitted && slot.item.typeState !== \"offline\"\r\n        ? ++acc\r\n        : acc;\r\n    }, 0);\r\n    const mountedCalibration = fit.rigSlots.reduce((acc, slot) => {\r\n      const calibration = findAttributebyID(slot.item, 1153); //attributeID: 1153, attributeName: \"Calibration cost\"\r\n      return !!calibration && slot.item.typeState !== \"offline\"\r\n        ? acc + calibration\r\n        : acc;\r\n    }, 0);\r\n    const mountedDroneBandwidth = fit.droneSlots.reduce((acc, slot) => {\r\n      const droneBandwidth = findAttributebyID(slot.item, 1272); //attributeID: 1272, attributeName: \"Bandwidth Needed\"\r\n      return !!droneBandwidth && slot.item.typeState === \"activation\"\r\n        ? acc + droneBandwidth * slot.item.typeCount\r\n        : acc;\r\n    }, 0);\r\n    const mountedDronebay = fit.droneSlots.reduce((acc, slot) => {\r\n      const droneVolume = slot.item.volume;\r\n      return !!droneVolume && slot.item.typeState !== \"offline\"\r\n        ? acc + droneVolume * slot.item.typeCount\r\n        : acc;\r\n    }, 0);\r\n    const droneActive = fit.droneSlots.reduce((acc, slot) => {\r\n      if (slot.item.typeState === \"activation\")\r\n        return acc + (slot.item.typeCount || 0);\r\n      return acc;\r\n    }, 0);\r\n\r\n    return {\r\n      capacity: {\r\n        turret: turretHardpoint,\r\n        launcher: launcherHardpoint,\r\n        calibration: calibration,\r\n        droneBay: droneCapacity,\r\n        droneBandwidth: droneBandwidth,\r\n        droneActive: 5,\r\n      },\r\n      load: {\r\n        turret: mountedTurrets,\r\n        launcher: mountedLaunchers,\r\n        calibration: mountedCalibration,\r\n        droneBay: mountedDronebay,\r\n        droneBandwidth: mountedDroneBandwidth,\r\n        droneActive: droneActive,\r\n      },\r\n    };\r\n  }\r\n\r\n  static miscellaneous(fit) {\r\n    if (!fit?.ship?.typeID)\r\n      return {\r\n        sensor: {\r\n          scanResolution: 0,\r\n          maximumLockedTarget: 0,\r\n          maximumTargetingRange: 0,\r\n          strength: {\r\n            gravimetric: 0,\r\n            magnetometric: 0,\r\n            ladar: 0,\r\n            radar: 0,\r\n          },\r\n        },\r\n        propulsion: {\r\n          inertialModifier: 0,\r\n          maximumVelocity: 0,\r\n          warpSpeedMultiplier: 0,\r\n        },\r\n        misc: {\r\n          cargoBayCapacity: 0,\r\n          signatureRadius: 0,\r\n        },\r\n      };\r\n\r\n    const ship = fit.ship;\r\n\r\n    const scanResolution = findAttributebyID(ship, 564); //attributeID: 564, attributeName: \"Scan Resolution\"\r\n    const signatureRadius = findAttributebyID(ship, 552); //attributeID: 552, attributeName: \"Signature Radius\"\r\n\r\n    const gravimetricSensorStrength = findAttributebyID(ship, 211); //attributeID: 211, attributeName: \"Gravimetric Sensor Strength\"\r\n    const magnetometricSensorStrength = findAttributebyID(ship, 210); //attributeID: 210, attributeName: \"Magnetometric Sensor Strength\"\r\n    const ladarSensorStrength = findAttributebyID(ship, 209); // attributeID: 209, attributeName: \"Ladar Sensor Strength\"\r\n    const radarSensorStrength = findAttributebyID(ship, 208); //attributeID: 208, attributeName: \"RADAR Sensor Strength\"\r\n    const maximumLockedTarget = findAttributebyID(ship, 192); //attributeID: 192, attributeName: \"Maximum Locked Targets\"\r\n    const maximumTargetingRange = findAttributebyID(ship, 76); // attributeID: 76, attributeName: \"Maximum Targeting Range\"\r\n\r\n    const inertialModifier = findAttributebyID(ship, 70); // attributeID: 70, attributeName: \"Inertia Modifier\"\r\n    const maximumVelocity = Stat.#miscellaneous_maximumVelocity(fit);\r\n    const warpSpeedMultiplier = findAttributebyID(ship, 600); //attributeID: 600, attributeName: \"Warp Speed Multiplier\"\r\n\r\n    const cargoBayCapacity = findAttributebyID(ship.capacity);\r\n\r\n    return {\r\n      sensor: {\r\n        scanResolution,\r\n        maximumLockedTarget,\r\n        maximumTargetingRange,\r\n        strength: {\r\n          gravimetric: gravimetricSensorStrength,\r\n          magnetometric: magnetometricSensorStrength,\r\n          ladar: ladarSensorStrength,\r\n          radar: radarSensorStrength,\r\n        },\r\n      },\r\n      propulsion: {\r\n        inertialModifier,\r\n        maximumVelocity,\r\n        warpSpeedMultiplier,\r\n      },\r\n      misc: {\r\n        signatureRadius,\r\n        cargoBayCapacity,\r\n      },\r\n    };\r\n  }\r\n  static #miscellaneous_maximumVelocity = function (fit) {\r\n    const activePropulsionModules = Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        const isPropulsionModule = !!slot.item?.typeEffectsStats?.find((efft) =>\r\n          [6730, 6731].includes(efft.effectID)\r\n        ); // effectID: 6731, effectName: \"moduleBonusAfterburner\"\r\n        // effectID: 6730, effectName: \"moduleBonusMicrowarpdrive\"\r\n        const isActive = slot.item.typeState === \"activation\";\r\n\r\n        if (isActive && isPropulsionModule) return slot.item;\r\n        else return undefined;\r\n      },\r\n      { isIterate: { midSlots: true } }\r\n    ).filter((slot) => !!slot);\r\n    const shipBaseMaximumVelocity = findAttributebyID(fit.ship, 37); //attributeID: 37, attributeName: \"Maximum Velocity\"\r\n    if (activePropulsionModules.length === 0) return shipBaseMaximumVelocity;\r\n\r\n    //prettier-ignore\r\n    const propModuleMaximumVelocityBonusMul = findAttributebyID( activePropulsionModules[0], 20) / 100 // attributeID: 20, attributeName: \"Maximum Velocity Bonus\"\r\n    const propModuleThrust = findAttributebyID(activePropulsionModules[0], 567); // attributeID: 567, attributeName: \"Thrust\",\r\n\r\n    const propModuleMassAdd = propModuleThrust / 3;\r\n    const shipMass = findAttributebyID(fit.ship, 4); // attributeID: 4, attributeName: \"Mass\";\r\n    const mass =\r\n      Fit.mapSlots(fit, (slot) => slot, {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n        },\r\n      }).reduce((acc, slot) => {\r\n        if (!!slot.item.mass) return acc + slot.item.mass;\r\n        return acc;\r\n      }, 0) +\r\n      propModuleMassAdd +\r\n      shipMass;\r\n\r\n    const shipAppliedMaximumVelocity =\r\n      shipBaseMaximumVelocity *\r\n      (1 + (propModuleMaximumVelocityBonusMul * propModuleThrust) / mass);\r\n\r\n    return shipAppliedMaximumVelocity;\r\n  };\r\n\r\n  static getActivationInfo(item, charge) {\r\n    if (!item)\r\n      return {\r\n        duration: Infinity,\r\n        e_duration: Infinity,\r\n        activationLimit: 0,\r\n        reloadTime: 0,\r\n        activationCost: 0,\r\n      };\r\n\r\n    const activationCost = findAttributebyID(item, 6) || 0; //attributeID: 6, attributeName: \"Activation Cost\"\r\n    const reloadTime = (findAttributebyID(item, 1795) || undefined) / 1000; //attributeID: 1795, attributeName: \"Reload Time\"\r\n    const activationTime =\r\n      (findAttributebyID(item, 73) || findAttributebyID(item, 51)) / 1000; // attributeID: 73, attributeName: \"Activation time / duration\" attributeID: 51, attributeName: \"Rate of fire\"\r\n\r\n    if (!reloadTime || !Stat.#getActivationInfo_isTypeNeedCharge(item))\r\n      return {\r\n        duration: activationTime,\r\n        e_duration: activationTime,\r\n        activationLimit: Infinity,\r\n        reloadTime: 0,\r\n        activationCost,\r\n      };\r\n    if (!Fit.validateChargeSlot({ item, charge }))\r\n      return {\r\n        duration: Infinity,\r\n        e_duration: Infinity,\r\n        activationLimit: 0,\r\n        reloadTime: 0,\r\n        activationCost,\r\n      };\r\n\r\n    const itemCapacity = item.capacity;\r\n    const chargeVolume = charge.volume;\r\n    const chargePerCycle = findAttributebyID(item, 56); //attributeID: 56, attributeName: \"Charges Per Cycle\"\r\n\r\n    const chargeVolumePerAct = !!chargePerCycle\r\n      ? chargeVolume * chargePerCycle\r\n      : 0;\r\n    const activationLimit = Math.floor(itemCapacity / chargeVolumePerAct);\r\n    const reloadTimePerAct =\r\n      !!reloadTime && !!itemCapacity && !!chargeVolume\r\n        ? reloadTime / activationLimit\r\n        : 0;\r\n    const EactivationTime = activationTime + reloadTimePerAct;\r\n\r\n    return {\r\n      duration: activationTime,\r\n      e_duration: EactivationTime,\r\n      activationLimit,\r\n      reloadTime,\r\n      activationCost,\r\n    };\r\n  }\r\n  static #getActivationInfo_isTypeNeedCharge = (type) => {\r\n    if (!type || !type.typeEffectsStats) return false;\r\n\r\n    //TODO: Add command burst effectIDs\r\n    //effectID: 42, effectName: \"turretFitted\"\r\n    //effectID: 40, effectName: \"launcherFitted\"\r\n    //effectID: 48, effectName: \"powerBooster\"\r\n    const thisEffectsNeedCharge = [42, 40, 48];\r\n\r\n    return type.typeEffectsStats.reduce((acc, efft) => {\r\n      if (thisEffectsNeedCharge.includes(efft.effectID)) return true;\r\n      return acc;\r\n    }, false);\r\n  };\r\n\r\n  static getAmbientChargeRateMath = (Cmax, Cnow, Tchg) => {\r\n    return ((10 * Cmax) / Tchg) * (Math.sqrt(Cnow / Cmax) - Cnow / Cmax) || 0;\r\n  };\r\n}\r\n","import { findAttributebyID } from \"../../../../services/dataManipulation/findAttributes\";\r\nimport Fit from \"../../../../fitter/src/Fit\";\r\nimport Stat from \"./Stat\";\r\n\r\nconst capPrioritySet = {\r\n  alwaysOn: 0,\r\n  mostTrivial: 10,\r\n  turretDamage: 1,\r\n  shieldHarden: 2,\r\n  shieldBoost: 2,\r\n  shieldBoostAncillaryFueled: 2,\r\n  shieldBoostAncillary: 5,\r\n  armorHardener: 2,\r\n  armorBoost: 2,\r\n  armorBoostAncillaryFueled: 3,\r\n  armorBoostAncillary: 5,\r\n  damageControl: 0,\r\n  structureBoost: 1,\r\n  capacitorNeutralizer: 3,\r\n  capacitorTransmitter: 4,\r\n};\r\n\r\nexport default class Summary extends Stat {\r\n  static updateSummaries = (summarizedSlots, situation) => {\r\n    Fit.mapSlots(\r\n      summarizedSlots,\r\n      (slot) => {\r\n        if (!slot.item) return;\r\n        /*  if (slot?.summary?.activationState?.isActive === false) */\r\n        // MUTATION!!\r\n        slot.item.typeState = \"passive\";\r\n        /*  else if (slot?.summary?.activationState?.isActive === true); */\r\n        // MUTATION!!\r\n        /*   slot.item.typeState = \"activation\"; */\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    );\r\n\r\n    const fit = Fit.apply(summarizedSlots);\r\n    const shipSummary = Summary.getSummary_ship(fit, situation);\r\n    shipSummary.load = summarizedSlots.summary.load;\r\n    // MUTATION!!\r\n    Object.assign(summarizedSlots.summary, shipSummary);\r\n\r\n    Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        if (!slot.item) return false;\r\n\r\n        const summary = Summary.#getSummaries_modules(slot);\r\n        const _slot = SimFit.toPath(summarizedSlots, summary.path);\r\n        if (!summary || !_slot) return false;\r\n\r\n        if (summary.activationState)\r\n          summary.activationState = _slot.summary.activationState;\r\n        if (!!summary.load) summary.load = _slot.summary.load;\r\n\r\n        // MUTATION!!\r\n        Object.assign(_slot.summary, summary);\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n        },\r\n      }\r\n    );\r\n    Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        if (!slot.item) return false;\r\n\r\n        const summary = Summary.#getSummaries_drones(slot);\r\n        const _slot = SimFit.toPath(summarizedSlots, summary.path);\r\n        if (!summary || !_slot) return false;\r\n\r\n        if (summary.activationState)\r\n          summary.activationState = _slot.summary.activationState;\r\n        if (!!summary.load) summary.load = _slot.summary.load;\r\n\r\n        // MUTATION!!\r\n        Object.assign(_slot.summary, summary);\r\n      },\r\n      {\r\n        isIterate: {\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    );\r\n\r\n    return summarizedSlots;\r\n  };\r\n\r\n  static addSummaries = (slots, situation) => {\r\n    const _slots = Summary.addSummaries_duplicateSlots(slots);\r\n    const fit = Fit.apply(_slots);\r\n\r\n    if (!!_slots) _slots[\"summary\"] = Summary.getSummary_ship(fit, situation);\r\n\r\n    Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        if (!slot.item) return false;\r\n\r\n        const summary = Summary.#getSummaries_modules(slot);\r\n        summary[\"root\"] = _slots;\r\n        const _slot = !!summary && SimFit.toPath(_slots, summary.path);\r\n        if (!!_slot) _slot[\"summary\"] = summary;\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n        },\r\n      }\r\n    );\r\n    Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        if (!slot.item) return false;\r\n\r\n        const summary = Summary.#getSummaries_drones(slot);\r\n        summary[\"root\"] = _slots;\r\n        const _slot = !!summary && SimFit.toPath(_slots, summary.path);\r\n        if (!!_slot) _slot[\"summary\"] = summary;\r\n      },\r\n      {\r\n        isIterate: {\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    );\r\n    return _slots;\r\n  };\r\n  static addSummaries_duplicateSlots = (slots) => {\r\n    const _droneSlots = Summary.addSummaries_duplicateDroneSlots(slots);\r\n    const _slots = JSON.parse(JSON.stringify(slots));\r\n    _slots.droneSlots = _droneSlots;\r\n\r\n    return _slots;\r\n  };\r\n  // duplicate droneslots to number of typecount\r\n  static addSummaries_duplicateDroneSlots = (slots) => {\r\n    let slotCount = 0;\r\n    return slots.droneSlots.reduce((acc, slot) => {\r\n      const slotString = JSON.stringify(slot);\r\n      const _slots = new Array(slot.item.typeCount || 1).fill(false).map(() => {\r\n        const _slot = JSON.parse(slotString);\r\n        if (!!_slot.item) {\r\n          _slot.typeCount = undefined;\r\n          _slot.item.domainID = `droneSlots.${slotCount}.item`;\r\n        }\r\n        slotCount++;\r\n\r\n        return _slot;\r\n      });\r\n\r\n      return acc.concat(_slots);\r\n    }, []);\r\n  };\r\n\r\n  static #getSummaries_modules = (slot) => {\r\n    if (!slot?.item?.typeEffectsStats) return false;\r\n    const item = slot.item;\r\n    const charge = slot.charge;\r\n\r\n    const structureHP = findAttributebyID(item, 9); //attributeID: 9, attributeName: \"Structure Hitpoints\"\r\n    const heatDamage = findAttributebyID(item, 1211); // attributeID: 1211, attributeName: \"Heat Damage\"\r\n\r\n    const moduleSummary = {\r\n      load: {\r\n        structure: { HP: structureHP },\r\n      },\r\n      capacity: {\r\n        structure: { HP: structureHP },\r\n        misc: { heatDamage: heatDamage },\r\n      },\r\n    };\r\n\r\n    const activationDataSet = Summary.createActivationDataSet(slot);\r\n    const path = item.domainID.split(\".\").slice(0, 2).join(\".\"); //eg)highSlots.1\r\n    const effectSummary = item.typeEffectsStats\r\n      .map((efft) => {\r\n        let summary = {};\r\n        let operation = false;\r\n        switch (efft.effectID) {\r\n          case 101: // effectID: 101, effectName: \"useMissiles\"\r\n          case 34: // effectID: 34, effectName: \"projectileFired\"\r\n          case 10: // effectID: 10, effectName: \"targetAttack\"\r\n          case 6995: // effectID: 6995, effectName: \"targetDisintegratorAttack\"\r\n            summary = Summary.getSummary_damage(item, charge);\r\n            if (!summary.damagePerAct.alpha) return false;\r\n            operation = \"damage\";\r\n            break;\r\n          case 4: // effectID: 4, effectName: \"shieldBoosting\"\r\n          case 26: // effectID: 26, effectName: \"structureRepair\"\r\n          case 4936: // effectID: 4936, effectName: \"fueledShieldBoosting\"\r\n          case 27: // effectID: 27, effectName: \"armorRepair\"\r\n          case 5275: // effectID: 5275, effectName: \"fueledArmorRepair\"\r\n            summary = Summary.getSummary_defense(item, charge);\r\n            operation = \"defense\";\r\n            break;\r\n          case 48: //effectID: 48, effectName: \"powerBooster\"\r\n          case 6187: //effectID: 6187, effectName: \"energyNeutralizerFalloff\"\r\n          case 6197: //effectID: 6197, effectName: \"energyNosferatuFalloff\"\r\n          case 6148: // effectID: 6184, effectName: \"shipModuleRemoteCapacitorTransmitter\"\r\n            summary = Summary.getSummary_capacitor(item, charge);\r\n            operation = \"capacitor\";\r\n            break;\r\n          case 5230: // effectID: 5230, effectName: \"modifyActiveShieldResonancePostPercent\"\r\n          case 4928: // effectID: 4928, effectName: \"adaptiveArmorHardener\" //TODO: reactive armor bonus should be calculated\r\n          case 5231: // effectID: 5231, effectName: \"modifyActiveArmorResonancePostPercent\"\r\n          case 7012: // effectID: 7012, effectName: \"moduleBonusAssaultDamageControl\"\r\n            operation = \"temporary\";\r\n            break;\r\n          default:\r\n            return false;\r\n        }\r\n\r\n        const activationPriority = Summary.getActivationPriority(efft);\r\n        activationDataSet.activationState[\"activationPriority\"] =\r\n          activationPriority;\r\n\r\n        return { ...summary, ...activationDataSet, operation };\r\n      })\r\n      .filter((summary) => !!summary);\r\n\r\n    if (effectSummary.length > 1)\r\n      console.error(\r\n        \"ERR: more than one summary produced in single module\",\r\n        slot\r\n      );\r\n    else return { ...moduleSummary, ...effectSummary[0], path };\r\n  };\r\n  static #getSummaries_drones = (slot) => {\r\n    if (!slot?.item?.typeEffectsStats) return false;\r\n    const item = slot.item;\r\n    const isSentry = item.marketGroupID === 911; // marketGroupID: 911 \"marketGroupName\": \"Sentry Drones\"\r\n\r\n    // These functions from Stat class is targeted for ship. modified to fit in drone in this case\r\n    const defense = this.defense_resistance({ ship: item });\r\n    const capacitor = this.capacitor_getChargeInfo({ ship: item });\r\n\r\n    const misc = this.miscellaneous({ ship: item });\r\n    const orbitVelocity = findAttributebyID(item, 508); // attributeID: 508, attributeName: \"Orbit Velocity\"\r\n    const orbitRange = findAttributebyID(item, 416); //attributeID: 416, attributeName: \"entityFlyRange\"\r\n    const maximumVelocity = findAttributebyID(item, 37); // attributeID: 37, attributeName: \"Maximum Velocity\"\r\n    misc.propulsion = {\r\n      ...misc.propulsion,\r\n      orbitVelocity,\r\n      orbitRange,\r\n      maximumVelocity,\r\n    };\r\n    const droneSumamry = {\r\n      load: {\r\n        armor: { HP: defense.armor.HP },\r\n        shield: { HP: defense.shield.HP },\r\n        structure: { HP: defense.structure.HP },\r\n        capacitor: { HP: capacitor.HP },\r\n      },\r\n      capacity: { ...defense, ...misc, capacitor },\r\n    };\r\n    const path = item.domainID.split(\".\").slice(0, 2).join(\".\");\r\n    const effectSummary = item.typeEffectsStats\r\n      .map((efft) => {\r\n        const activationDataSet = Summary.createActivationDataSet(slot);\r\n        let summary = {};\r\n        let operation = false;\r\n\r\n        switch (efft.effectID) {\r\n          case 101: // effectID: 101, effectName: \"useMissiles\"\r\n          case 34: // effectID: 34, effectName: \"projectileFired\"\r\n          case 10: // effectID: 10, effectName: \"targetAttack\"\r\n          case 6995: // effectID: 6995, effectName: \"targetDisintegratorAttack\"\r\n            summary = Summary.getSummary_drone(item);\r\n            if (!summary.damagePerAct.alpha) return false;\r\n            operation = \"damage\";\r\n            break;\r\n          default:\r\n            return false;\r\n        }\r\n        return { ...summary, ...activationDataSet, operation };\r\n      })\r\n      .filter((summary) => !!summary);\r\n\r\n    const situation_decription =\r\n      \"Currently situation is not calculated BUT! always hitted by smart bomb\";\r\n\r\n    if (effectSummary.length > 1)\r\n      console.error(\r\n        \"ERR: more than one summary produced in single module\",\r\n        slot\r\n      );\r\n    else\r\n      return {\r\n        ...droneSumamry,\r\n        ...effectSummary[0],\r\n        situation_decription,\r\n        isSentry,\r\n        isDrone: true,\r\n        path,\r\n      };\r\n  };\r\n  static createActivationDataSet = (slot) => {\r\n    const activationInfo = this.getActivationInfo(slot.item, slot.charge);\r\n\r\n    return {\r\n      activationInfo,\r\n      activationState: {\r\n        isActive: false,\r\n        lastActivation: 0,\r\n        nextActivation: 0,\r\n        nextActivationTick: 0,\r\n        activationLeft: activationInfo.activationLimit,\r\n      },\r\n    };\r\n  };\r\n  static getActivationPriority = (efft) => {\r\n    let activationPriority = 10;\r\n    switch (efft.effectID) {\r\n      case 6197: //effectID: 6197, effectName: \"energyNosferatuFalloff\"\r\n      case 48: //effectID: 48, effectName: \"powerBooster\"\r\n        activationPriority = capPrioritySet.alwaysOn;\r\n        break;\r\n      case 101: // effectID: 101, effectName: \"useMissiles\"\r\n      case 34: // effectID: 34, effectName: \"projectileFired\"\r\n      case 10: // effectID: 10, effectName: \"targetAttack\"\r\n      case 6995: // effectID: 6995, effectName: \"targetDisintegratorAttack\"\r\n        activationPriority = capPrioritySet.turretDamage;\r\n        break;\r\n      case 4: // effectID: 4, effectName: \"shieldBoosting\"\r\n        activationPriority = capPrioritySet.shieldBoost;\r\n        break;\r\n      case 26: // effectID: 26, effectName: \"structureRepair\"\r\n        activationPriority = capPrioritySet.structureBoost;\r\n        break;\r\n      case 4936: // effectID: 4936, effectName: \"fueledShieldBoosting\"\r\n        activationPriority = capPrioritySet.shieldBoostAncillaryFueled;\r\n        break;\r\n      case 27: // effectID: 27, effectName: \"armorRepair\"\r\n        activationPriority = capPrioritySet.armorBoost;\r\n        break;\r\n      case 5275: // effectID: 5275, effectName: \"fueledArmorRepair\"\r\n        activationPriority = capPrioritySet.armorBoostAncillaryFueled;\r\n        break;\r\n      case 6187: //effectID: 6187, effectName: \"energyNeutralizerFalloff\"\r\n        activationPriority = capPrioritySet.capacitorNeutralizer;\r\n        break;\r\n      case 6148: // effectID: 6184, effectName: \"shipModuleRemoteCapacitorTransmitter\"\r\n        activationPriority = capPrioritySet.capacitorTransmitter;\r\n        break;\r\n      case 5230: // effectID: 5230, effectName: \"modifyActiveShieldResonancePostPercent\"\r\n        activationPriority = capPrioritySet.shieldHardener;\r\n        break;\r\n      case 4928: // effectID: 4928, effectName: \"adaptiveArmorHardener\"\r\n      case 5231: // effectID: 5231, effectName: \"modifyActiveArmorResonancePostPercent\"\r\n        activationPriority = capPrioritySet.armorHardener;\r\n        break;\r\n      case 7012: // effectID: 7012, effectName: \"moduleBonusAssaultDamageControl\"\r\n        activationPriority = capPrioritySet.damageControl;\r\n        break;\r\n      default:\r\n        activationPriority = capPrioritySet.mostTrivial;\r\n    }\r\n\r\n    return activationPriority;\r\n  };\r\n  static getSummary_ship = (fit, situation) => {\r\n    const defense = this.defense_resistance(fit);\r\n    const misc = this.miscellaneous(fit);\r\n    const capacitor = this.capacitor_getChargeInfo(fit);\r\n\r\n    return {\r\n      load: {\r\n        armor: { HP: defense.armor.HP },\r\n        shield: { HP: defense.shield.HP },\r\n        structure: { HP: defense.structure.HP },\r\n        capacitor: { HP: capacitor.HP },\r\n      },\r\n      capacity: { ...defense, ...misc, capacitor },\r\n      situation: situation,\r\n    };\r\n  };\r\n\r\n  static getSummary_damage(item, charge) {\r\n    if (!item) return false;\r\n\r\n    const damagePerAct = this.damage_damagePerAct(item, charge);\r\n    const range = this.damage_range(item, charge);\r\n\r\n    return { damagePerAct, range };\r\n  }\r\n  static getSummary_drone(item) {\r\n    if (!item) return false;\r\n\r\n    const damagePerAct = this.damage_damagePerAct(item, item);\r\n    const range = this.damage_range(item, item);\r\n\r\n    return { damagePerAct, range };\r\n  }\r\n  static getSummary_defense(item, charge) {\r\n    if (!item) return false;\r\n\r\n    const bonusPerAct = this.defense_getBonusPerAct(item, charge);\r\n\r\n    return { bonusPerAct: { self: bonusPerAct } };\r\n  }\r\n  static getSummary_capacitor(item, charge) {\r\n    if (!item) return false;\r\n    const booster_bonusPerAct = findAttributebyID(charge, 67) || 0; //attributeID: 67, attributeName: \"Capacitor Bonus\"\r\n    const transfer_bonusPerAct = findAttributebyID(item, 90) || 0; // attributeID: 90, attributeName: \"Energy transfer amount\"\r\n    const neut_bonusPerAct = findAttributebyID(item, 97) || 0; // attributeID: 97, attributeName: \"Neutralization Amount\"\r\n\r\n    const isNosferatuBloodRaiderOverriden = findAttributebyID(item, 1945) === 1; //attributeID: 1945, attributeName: \"nosOverride\"\r\n    const isCapacitorTransmitter = !!findAttributebyID(item, 3423); //attributeID: 182, attributeName: \"Primary Skill required\" (3423: capacitor emission system)\r\n    const isNosferatu = !isCapacitorTransmitter && !!transfer_bonusPerAct;\r\n\r\n    const bonusPerAct_self = isCapacitorTransmitter\r\n      ? 0\r\n      : booster_bonusPerAct + transfer_bonusPerAct;\r\n    const bonusPerAct_target = isCapacitorTransmitter\r\n      ? transfer_bonusPerAct\r\n      : -transfer_bonusPerAct - neut_bonusPerAct;\r\n\r\n    const optimalRange = findAttributebyID(item, 54); //attributeID: 54, attributeName: \"Optimal Range\"\r\n    const falloffRange = findAttributebyID(item, 2044); //attributeID: 2044, attributeName: \"Effectiveness Falloff\"\r\n\r\n    return {\r\n      bonusPerAct: { self: bonusPerAct_self, target: bonusPerAct_target },\r\n      range: { optimalRange, falloffRange },\r\n      isNosferatuBloodRaiderOverriden,\r\n      isCapacitorTransmitter,\r\n      isNosferatu,\r\n    };\r\n  }\r\n}\r\n\r\nclass SimFit extends Fit {\r\n  static changeStateOfModule(slots, path, state) {\r\n    if (![\"overload\", \"activation\", \"passive\", \"offline\"].includes(state))\r\n      return false;\r\n\r\n    const targetSlot = this.toPath(slots, path);\r\n    if (!targetSlot || !targetSlot.item) return false;\r\n\r\n    targetSlot.item.typeState = state;\r\n    const fit = this.apply(slots);\r\n    return fit;\r\n  }\r\n  static toPath(slots, path) {\r\n    if (!slots || !path) return {};\r\n    return path.split(\".\").reduce((p, c) => (p && p[c]) || undefined, slots);\r\n  }\r\n}\r\n","import Fit from \"../../../../fitter/src/Fit\";\r\nimport EveMath from \"./EveMath\";\r\nimport Summary from \"./Summary\";\r\n\r\nexport default class Simulator {\r\n  static test(slots, fit1, situation) {\r\n    const summarizedSlots1 = Summary.addSummaries(slots, situation.onboard);\r\n    const summarizedSlots2 = Summary.addSummaries(fit1, situation.hostile);\r\n    console.log(summarizedSlots1, summarizedSlots2, situation);\r\n\r\n    Fit.mapSlots(\r\n      summarizedSlots1,\r\n      (slot) => {\r\n        if (!slot?.summary?.activationState) return false;\r\n        slot.summary.activationState.isActive = true;\r\n        slot.summary.activationState.nextActivationTick = 0;\r\n        slot.summary.activationState.nextActivation = 0;\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    );\r\n\r\n    console.log(\r\n      \"CAPACITOR_BY_LEVEL\",\r\n      HAL.manageActivation_getCapUsageLevels(summarizedSlots1)\r\n    );\r\n    const capLog = [];\r\n    for (let i = 0; i < 2; i++) {\r\n      const schedules = HAL.getSchedules(summarizedSlots1, summarizedSlots2, i);\r\n      console.log(schedules);\r\n      HAL.manageSchedules(schedules, summarizedSlots1, situation.onboard);\r\n\r\n      capLog.push({ x: i, y: summarizedSlots1.summary.load.capacitor.HP });\r\n    }\r\n\r\n    console.log(capLog);\r\n  }\r\n\r\n  static simulate_oneTick = (owner, target, tick) => {\r\n    Simulator.simulate_capacitor(owner);\r\n    Simulator.simulate_shield(owner);\r\n    Fit.mapSlots(\r\n      fit,\r\n      (slot) => {\r\n        if (!slot.summary) return false;\r\n\r\n        switch (slot.summary.operation) {\r\n          case \"damage\":\r\n            Simulator.activateDamage(slot.summary, owner, target, tick);\r\n            break;\r\n          case \"defense\":\r\n            Simulator.activateDefense(slot.summary, owner, target, tick);\r\n            break;\r\n          case \"capacitor\":\r\n            Simulator.activateCapacitor(slot.summary, owner, target, tick);\r\n            break;\r\n        }\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    );\r\n  };\r\n  static simulate_capacitor = (target) => {\r\n    const capacitorState = target.summary.load.capacitor;\r\n    const capacitorInfo = target.summary.capacity.capacitor;\r\n\r\n    const ambientChargeRate = EveMath.getAmbientChargeRateMath(\r\n      capacitorInfo.HP,\r\n      capacitorState.HP,\r\n      capacitorInfo.bonusRate\r\n    );\r\n\r\n    // MUTATION!\r\n    capacitorState.HP += ambientChargeRate;\r\n    if (capacitorState.HP === 0) capacitorState.HP = 1;\r\n\r\n    return ambientChargeRate;\r\n  };\r\n  static simulate_shield = (target) => {\r\n    const shieldState = target.summary.load.shield;\r\n    const shieldInfo = target.summary.capacity.shield;\r\n\r\n    const ambientChargeRate = EveMath.getAmbientChargeRateMath(\r\n      shieldInfo.HP,\r\n      shieldState.HP,\r\n      shieldInfo.bonusRate\r\n    );\r\n\r\n    // MUTATION!\r\n    shieldState.HP += ambientChargeRate;\r\n    if (shieldState.HP === 0) shieldState.HP += 1;\r\n\r\n    return ambientChargeRate;\r\n  };\r\n  //Currently target boost (remote armor repair is nor possible)\r\n  static activateDefense = (summary) => {\r\n    const owner = summary.root;\r\n\r\n    // MUTATION!\r\n    owner.summary.load.shield.HP += summary.bonusPerAct.self.shield;\r\n    if (owner.summary.capacity.shield.HP < owner.summary.load.shield.HP)\r\n      owner.summary.load.shield.HP = owner.summary.capacity.shield.HP;\r\n\r\n    owner.summary.load.armor.HP += summary.bonusPerAct.self.armor;\r\n    if (owner.summary.capacity.armor.HP < owner.summary.load.armor.HP)\r\n      owner.summary.load.armor.HP = owner.summary.capacity.armor.HP;\r\n\r\n    owner.summary.load.structure.HP += summary.bonusPerAct.self.structure;\r\n    if (owner.summary.capacity.structure.HP < owner.summary.load.structure.HP)\r\n      owner.summary.load.structure.HP = owner.summary.capacity.structure.HP;\r\n    /*  } */\r\n  };\r\n\r\n  static activateDamage = (summary) => {\r\n    const owner = summary.isDrone ? summary : summary.root;\r\n    const target = summary.target;\r\n    //prettier-ignore\r\n    const situationalModifiedSummary = Simulator.#activateDamage_getSituationalModifiedSummary(summary, owner, target);\r\n    //prettier-ignore\r\n    const alpha = Simulator.activateDamage_getAlpha(situationalModifiedSummary, target);\r\n    // MUTATION!\r\n    target.summary.load.shield.HP -= alpha.shield;\r\n    if (target.summary.load.shield.HP < 0) target.summary.load.shield.HP = 0;\r\n    target.summary.load.armor.HP -= alpha.armor;\r\n    if (target.summary.load.armor.HP < 0) target.summary.load.armor.HP = 0;\r\n    target.summary.load.structure.HP -= alpha.structure;\r\n    if (target.summary.load.structure.HP < 0)\r\n      target.summary.load.structure.HP = 0;\r\n  };\r\n  static activateDamage_getAlpha = (summary, target) => {\r\n    if (!summary.damagePerAct.alpha)\r\n      return { shield: 0, armor: 0, structure: 0 };\r\n\r\n    //prettier-ignore\r\n    const shieldDamage = Simulator.#activateDamage_getDamageResult(summary.damagePerAct, target, \"shield\");\r\n    if (shieldDamage.remaining.alpha <= 0.01)\r\n      return { shield: shieldDamage.appplied.alpha, armor: 0, structure: 0 };\r\n\r\n    //prettier-ignore\r\n    const armorDamage = Simulator.#activateDamage_getDamageResult(shieldDamage.remaining, target, \"armor\");\r\n    if (armorDamage.remaining.alpha <= 0.01)\r\n      return {\r\n        shield: shieldDamage.appplied.alpha,\r\n        armor: armorDamage.appplied.alpha,\r\n        structure: 0,\r\n      };\r\n\r\n    //prettier-ignore\r\n    const structureDamage = Simulator.#activateDamage_getDamageResult(armorDamage.remaining, target, \"structure\");\r\n    return {\r\n      shield: shieldDamage.appplied.alpha,\r\n      armor: armorDamage.appplied.alpha,\r\n      structure: structureDamage.appplied.alpha,\r\n    };\r\n  };\r\n  static #activateDamage_getDamageResult = (damagePerAct, target, type) => {\r\n    //prettier-ignore\r\n    const shot = Simulator.#activateDamage_getShot(damagePerAct, target, type);\r\n    const damageCapMultiplier =\r\n      target.summary.load[type].HP / shot.alpha_damaging < 1\r\n        ? target.summary.load[type].HP / shot.alpha_damaging\r\n        : 1;\r\n\r\n    const EM_applied = shot.EM_damaging * damageCapMultiplier;\r\n    const TH_applied = shot.TH_damaging * damageCapMultiplier;\r\n    const KI_applied = shot.KI_damaging * damageCapMultiplier;\r\n    const EX_applied = shot.EX_damaging * damageCapMultiplier;\r\n    const alpha_applied = EM_applied + TH_applied + KI_applied + EX_applied;\r\n\r\n    const EM_remaining = damagePerAct.EM - EM_applied - shot.EM_blocked;\r\n    const TH_remaining = damagePerAct.TH - TH_applied - shot.TH_blocked;\r\n    const KI_remaining = damagePerAct.KI - KI_applied - shot.KI_blocked;\r\n    const EX_remaining = damagePerAct.EX - EX_applied - shot.EX_blocked;\r\n    const alpha_remaining =\r\n      EM_remaining + TH_remaining + KI_remaining + EX_remaining;\r\n\r\n    return {\r\n      appplied: {\r\n        alpha: alpha_applied,\r\n        EM: EM_applied,\r\n        TH: TH_applied,\r\n        KI: KI_applied,\r\n        EX: EX_applied,\r\n      },\r\n      remaining: {\r\n        alpha: alpha_remaining,\r\n        EM: EM_remaining,\r\n        TH: TH_remaining,\r\n        KI: KI_remaining,\r\n        EX: EX_remaining,\r\n      },\r\n    };\r\n  };\r\n  static #activateDamage_getShot = (damagePerAct, target, type) => {\r\n    const EM_blocked =\r\n      (damagePerAct.EM * target.summary.capacity[type].EM) / 100;\r\n    const TH_blocked =\r\n      (damagePerAct.TH * target.summary.capacity[type].TH) / 100;\r\n    const KI_blocked =\r\n      (damagePerAct.KI * target.summary.capacity[type].KI) / 100;\r\n    const EX_blocked =\r\n      (damagePerAct.EX * target.summary.capacity[type].EX) / 100;\r\n    const alpha_blocked = EM_blocked + TH_blocked + KI_blocked + EX_blocked;\r\n\r\n    const EM_damaging = damagePerAct.EM - EM_blocked;\r\n    const TH_damaging = damagePerAct.TH - TH_blocked;\r\n    const KI_damaging = damagePerAct.KI - KI_blocked;\r\n    const EX_damaging = damagePerAct.EX - EX_blocked;\r\n    const alpha_damaging =\r\n      EM_damaging + TH_damaging + KI_damaging + EX_damaging;\r\n\r\n    return {\r\n      alpha_damaging,\r\n      EM_damaging,\r\n      TH_damaging,\r\n      KI_damaging,\r\n      EX_damaging,\r\n      alpha_blocked,\r\n      EM_blocked,\r\n      TH_blocked,\r\n      KI_blocked,\r\n      EX_blocked,\r\n    };\r\n  };\r\n  static #activateDamage_getSituationalModifiedSummary = (\r\n    summary,\r\n    owner,\r\n    target\r\n  ) => {\r\n    const situationalMul = Simulator.#activateDamage_getSituationalMul(\r\n      summary,\r\n      owner,\r\n      target\r\n    );\r\n\r\n    return {\r\n      ...summary,\r\n      damagePerAct: {\r\n        alpha: summary.damagePerAct.alpha * situationalMul,\r\n        EM: summary.damagePerAct.EM * situationalMul,\r\n        TH: summary.damagePerAct.TH * situationalMul,\r\n        KI: summary.damagePerAct.KI * situationalMul,\r\n        EX: summary.damagePerAct.EX * situationalMul,\r\n      },\r\n    };\r\n  };\r\n  static #activateDamage_getSituationalMul = (summary, owner, target) => {\r\n    if (summary.isDrone) {\r\n      //prettier-ignore\r\n      const droneAccuracy = EveMath.getDroneAccracy(summary, owner, target);\r\n\r\n      return Math.random() <= droneAccuracy\r\n        ? EveMath.getTurretRandomDamageModifier()\r\n        : 0;\r\n    } else if (!!summary.range.tracking) {\r\n      //prettier-ignore\r\n      const turretAccuracy = EveMath.getTurretAcurracy(summary, owner, target);\r\n\r\n      return Math.random() <= turretAccuracy\r\n        ? EveMath.getTurretRandomDamageModifier()\r\n        : 0;\r\n    } else if (!!summary.range.explosionRadius) {\r\n      //prettier-ignore\r\n      const launcherAccracy = EveMath.getLauncherAccuracy(summary, owner, target);\r\n\r\n      return Math.random() <= launcherAccracy\r\n        ? EveMath.getLauncherDamageModifier(summary, target)\r\n        : 0;\r\n    } else return 0;\r\n  };\r\n\r\n  static activateCapacitor = (summary) => {\r\n    const owner = summary.root;\r\n    const target = summary.target;\r\n    //prettier-ignore\r\n    const situationalModifiedSummary = Simulator.#activateCapacitor_getSituationalModifiedSummary(summary, owner, target);\r\n\r\n    // MUTATION!\r\n    target.summary.load.capacitor.HP +=\r\n      situationalModifiedSummary.bonusPerAct.target;\r\n    if (target.summary.load.capacitor.HP < 0)\r\n      target.summary.load.capacitor.HP = 0;\r\n    if (target.summary.capacity.capacitor.HP < target.summary.load.capacitor.HP)\r\n      target.summary.load.capacitor.HP = target.summary.capacity.capacitor.HP;\r\n\r\n    owner.summary.load.capacitor.HP +=\r\n      situationalModifiedSummary.bonusPerAct.owner;\r\n    if (owner.summary.load.capacitor.HP < 0)\r\n      owner.summary.load.capacitor.HP = 0;\r\n    if (owner.summary.capacity.capacitor.HP < owner.summary.load.capacitor.HP)\r\n      owner.summary.load.capacitor.HP = owner.summary.capacity.capacitor.HP;\r\n  };\r\n  static #activateCapacitor_getSituationalModifiedSummary = (\r\n    summary,\r\n    owner,\r\n    target\r\n  ) => {\r\n    const ownerCapacitorHP = owner.summary.load.capacitor.HP;\r\n    const targetCapacitorHP = target.summary.load.capacitor.HP;\r\n\r\n    // prettier-ignore\r\n    const situationalMul = Simulator.#activateCapacitor_getSituationalMul(summary, owner, target);\r\n    const bonusPerActOwner = summary.bonusPerAct.self * situationalMul;\r\n    const bonusPerActTarget = summary.bonusPerAct.target * situationalMul;\r\n\r\n    if (summary.isNosferatu) {\r\n      const maxBonusPerAct = Math.min(bonusPerActOwner, targetCapacitorHP);\r\n      let symmetricBonusPerAct = maxBonusPerAct;\r\n\r\n      if (\r\n        !summary.isNosferatuBloodRaiderOverriden &&\r\n        targetCapacitorHP + bonusPerActTarget < ownerCapacitorHP\r\n      )\r\n        symmetricBonusPerAct = Math.max(\r\n          Math.floor((targetCapacitorHP - ownerCapacitorHP) / 2),\r\n          0\r\n        );\r\n      symmetricBonusPerAct = Math.min(maxBonusPerAct, symmetricBonusPerAct);\r\n      return {\r\n        ...summary,\r\n        bonusPerAct: {\r\n          self: symmetricBonusPerAct,\r\n          target: -symmetricBonusPerAct,\r\n        },\r\n      };\r\n    }\r\n\r\n    return {\r\n      ...summary,\r\n      bonusPerAct: {\r\n        owner: bonusPerActOwner,\r\n        target: bonusPerActTarget,\r\n      },\r\n    };\r\n  };\r\n  static #activateCapacitor_getSituationalMul = (summary, owner, target) => {\r\n    const rangeModifier = EveMath.getRangeModifier(summary, owner, target);\r\n\r\n    const isCapacitorBooster = summary.slot.item?.typeEffectsStats?.reduce(\r\n      (acc, efft) => {\r\n        if (efft.effectID === 48)\r\n          //effectID: 48, effectName: \"powerBooster\"\r\n          return true;\r\n        return acc;\r\n      },\r\n      false\r\n    );\r\n\r\n    return isCapacitorBooster ? 1 : rangeModifier;\r\n  };\r\n\r\n  static simulateActivation = (summary) => {\r\n    const capacitorState =\r\n      summary.load.capacitor || summary.root.summary.load.capacitor;\r\n    const state = summary.activationState;\r\n    const info = summary.activationInfo;\r\n\r\n    // MUTATION!\r\n    capacitorState.HP -= info.activationCost;\r\n    state.activationLeft--;\r\n    state.lastActivation = state.nextActivation;\r\n\r\n    // Check if ammo left is 0, set time\r\n    if (state.activationLeft === 0) {\r\n      state.nextActivation =\r\n        state.lastActivation + info.duration + info.reloadTime;\r\n      state.activationLeft = info.activationLimit;\r\n    } else\r\n      state.nextActivation = Number(\r\n        (state.lastActivation + info.duration).toFixed(10)\r\n      );\r\n\r\n    state.nextActivationTick = Math.floor(state.nextActivation);\r\n\r\n    return summary;\r\n  };\r\n}\r\nexport class HAL {\r\n  static getSchedules(summarizedSlots, target, tick) {\r\n    HAL.getSchedules_setTarget(summarizedSlots, target);\r\n    return Fit.mapSlots(\r\n      summarizedSlots,\r\n      (summarizedSlot) => {\r\n        if (!summarizedSlot.summary) return false;\r\n        return HAL.#getSchedules_getFragment(summarizedSlot.summary, tick);\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    )\r\n      .reduce((acc, fragment) => {\r\n        if (!fragment) return acc;\r\n        return acc.concat(fragment);\r\n      }, [])\r\n      .sort((a, b) => a.time - b.time);\r\n  }\r\n  static getSchedules_setTarget = (summarizedSlots, target) => {\r\n    Fit.mapSlots(\r\n      summarizedSlots,\r\n      (summarizedSlot) => {\r\n        if (!summarizedSlot.summary) return false;\r\n        let _target = false;\r\n        switch (summarizedSlot?.summary?.operation) {\r\n          case \"damage\":\r\n          case \"defense\":\r\n          case \"capacitor\":\r\n            _target = target;\r\n            break;\r\n          default:\r\n            _target = false;\r\n            break;\r\n        }\r\n        summarizedSlot.summary[\"target\"] = _target;\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n          droneSlots: true,\r\n        },\r\n      }\r\n    );\r\n  };\r\n  static #getSchedules_getFragment = (summary, tick) => {\r\n    const _summary = HAL.#getSchedules_copySummary(summary);\r\n    const fragment = HAL.#getSchedules_getFragmentRecursion(_summary, tick);\r\n    return fragment.map((schedule) => {\r\n      schedule[\"summary\"] = summary;\r\n      return schedule;\r\n    });\r\n  };\r\n  static #getSchedules_copySummary = (summary) => {\r\n    const _summary = JSON.parse(\r\n      JSON.stringify({ ...summary, root: undefined, target: undefined })\r\n    );\r\n    if (!!_summary?.activationState)\r\n      Object.keys(_summary.activationState).forEach((key) => {\r\n        if (_summary.activationState[key] === null)\r\n          // MUTATION!!\r\n          _summary.activationState[key] = Infinity;\r\n      });\r\n    if (!!_summary?.activationInfo)\r\n      Object.keys(_summary.activationInfo).forEach((key) => {\r\n        if (_summary.activationInfo[key] === null)\r\n          // MUTATION!!\r\n          _summary.activationInfo[key] = Infinity;\r\n      });\r\n\r\n    return _summary;\r\n  };\r\n  static #getSchedules_getFragmentRecursion = (summary, tick) => {\r\n    if (\r\n      !summary?.activationState?.isActive ||\r\n      summary?.activationState?.nextActivationTick !== tick\r\n    )\r\n      return [];\r\n    const currentTime = summary.activationState.nextActivation;\r\n    const state = summary.activationState;\r\n    const info = summary.activationInfo;\r\n    //prettier-ignore TODO: for testing, check tick is okay\r\n    if (state.isActive && state.nextActivationTick < tick)\r\n      console.warn(\"ERR: Tick is not in sync\");\r\n\r\n    // MUTATION!\r\n    state.activationLeft--;\r\n    state.lastActivation = state.nextActivation;\r\n\r\n    // Check if ammo left is 0, set time\r\n    if (state.activationLeft === 0) {\r\n      state.nextActivation =\r\n        state.lastActivation + info.duration + info.reloadTime;\r\n      state.activationLeft = info.activationLimit;\r\n    } else\r\n      state.nextActivation = Number(\r\n        (state.lastActivation + info.duration).toFixed(10)\r\n      );\r\n\r\n    state.nextActivationTick = Math.floor(state.nextActivation);\r\n\r\n    // Check if next activation is in same tick\r\n    let subSecSchedule = [];\r\n    if (state.nextActivationTick === tick)\r\n      subSecSchedule = HAL.#getSchedules_getFragmentRecursion(summary, tick);\r\n\r\n    return [{ time: currentTime }, ...subSecSchedule];\r\n  };\r\n\r\n  static manageSchedules(schedules, summarizedSlot, situation) {\r\n    schedules.forEach((schedule) => {\r\n      if (!HAL.manageSchedules_validate(schedule.summary)) {\r\n        // MUTATION!\r\n        schedule.summary.activationState.isActive = false;\r\n        if (schedule.summary.operation === \"temporary\")\r\n          Summary.updateSummaries(summarizedSlot, situation);\r\n\r\n        return;\r\n      } // TODO: loop through schedules with tick is moving\r\n\r\n      HAL.#manageSchedules_executeSchedule(schedule);\r\n    });\r\n  }\r\n  static #manageSchedules_executeSchedule = (schedule) => {\r\n    Simulator.simulateActivation(schedule.summary);\r\n    switch (schedule.summary.operation) {\r\n      case \"damage\":\r\n        Simulator.activateDamage(schedule.summary);\r\n        break;\r\n      case \"defense\":\r\n        Simulator.activateDefense(schedule.summary);\r\n        break;\r\n      case \"capacitor\":\r\n        Simulator.activateCapacitor(schedule.summary);\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n  static manageSchedules_validate(summary) {\r\n    if (!summary || !summary.activationState.isActive) return false;\r\n\r\n    const isCapacitorValidated = HAL.manageSchedules_validateCapacitor(summary);\r\n    const isStructureValidated = HAL.manageSchedules_validateStructure(summary);\r\n    if (!isCapacitorValidated || !isStructureValidated) return false;\r\n\r\n    return true;\r\n  }\r\n  static manageSchedules_validateCapacitor(summary) {\r\n    const activationInfo = summary.activationInfo;\r\n    const capacitorState =\r\n      summary?.load?.capacitor || summary.root.summary.load.capacitor;\r\n\r\n    if (capacitorState.HP < activationInfo.activationCost) return false;\r\n    else return true;\r\n  }\r\n  static manageSchedules_validateStructure(summary) {\r\n    const structureHP = summary?.load?.structure?.HP;\r\n    const rootStructureHP = summary.root.summary.load.structure.HP;\r\n\r\n    if (structureHP <= 0 || rootStructureHP <= 0) return false;\r\n    else return true;\r\n  }\r\n\r\n  // currently on halt. no ai included\r\n  static manageActivation(summarizedSlots, tick) {\r\n    // Find out current tick's cap usage amount\r\n    const capUsage = 0;\r\n    Fit.mapSlots(\r\n      summarizedSlots,\r\n      (summarizedSlot) => {\r\n        if (summarizedSlot.summary.activationState.nextActivationTick != tick)\r\n          return false;\r\n\r\n        capUsage += summarizedSlot.summary.activationInfo.activationCost;\r\n      },\r\n      {\r\n        isIterate: {\r\n          highSlots: true,\r\n          midSlots: true,\r\n          lowSlots: true,\r\n        },\r\n      }\r\n    );\r\n\r\n    if (\r\n      summarizedSlots.summary.load.capacitor.HP - capUsage <\r\n      summarizedSlots.summary.capacity.capacitor.HP * 0.3\r\n    )\r\n      return;\r\n  }\r\n  static manageActivation_getCapUsageLevels = (summarizedSlots) => {\r\n    return [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((activationPriority) => {\r\n      const capUsageRates = [];\r\n      Fit.mapSlots(\r\n        summarizedSlots,\r\n        (slot) => {\r\n          const info = slot?.summary?.activationInfo;\r\n          const state = slot?.summary?.activationState;\r\n          if (!info || !state || state.activationPriority > activationPriority)\r\n            return 0;\r\n          const capUsageRate = info.activationCost / info.duration || 0;\r\n          capUsageRates.push({ capUsageRate, slot });\r\n        },\r\n        {\r\n          isIterate: {\r\n            highSlots: true,\r\n            midSlots: true,\r\n            lowSlots: true,\r\n          },\r\n        }\r\n      );\r\n\r\n      return { activationPriority, capUsageRates };\r\n    });\r\n  };\r\n}\r\n","export default function _readOnlyError(name) {\n  throw new Error(\"\\\"\" + name + \"\\\" is read-only\");\n}","import Simulator from \"./Simulator\";\r\n\r\nexport const simulate = (slots, slots1, situation) => {\r\n  Simulator.test(slots, slots1, situation);\r\n};\r\n"],"sourceRoot":""}